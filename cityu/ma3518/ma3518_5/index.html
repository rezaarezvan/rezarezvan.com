<!DOCTYPE html><html lang="en"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/icon" href="/favicon.ico"><meta name="generator" content="Astro v5.1.1"><!-- Canonical URL --><link rel="canonical" href="https://rezvan.xyz/cityu/ma3518/ma3518_5/"><!-- Primary Meta Tags --><title>Part 5 - Multiple Linear Regression | applied statistics | rezarezvan.com</title><meta name="title" content="Part 5 - Multiple Linear Regression | applied statistics | rezarezvan.com"><meta name="description"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://rezvan.xyz/cityu/ma3518/ma3518_5/"><meta property="og:title" content="Part 5 - Multiple Linear Regression | applied statistics | rezarezvan.com"><meta property="og:description"><meta property="og:image" content="https://rezvan.xyz/favicon.ico"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://rezvan.xyz/cityu/ma3518/ma3518_5/"><meta property="twitter:title" content="Part 5 - Multiple Linear Regression | applied statistics | rezarezvan.com"><meta property="twitter:description"><meta property="twitter:image" content="https://rezvan.xyz/favicon.ico"><!-- PageFind --><link href="/pagefind/pagefind-ui.css" rel="stylesheet"><script src="/pagefind/pagefind-ui.js"></script><!-- KaTeX support --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.15/dist/katex.min.css" integrity="sha384-Htz9HMhiwV8GuQ28Xr9pEs1B4qJiYu/nYLLwlDklR53QibDfmQzi7rYxXhMH/5/u" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.15/dist/katex.min.js" integrity="sha384-bxmi2jLGCvnsEqMuYLKE/KsVCxV3PqmKeK6Y6+lmNXBry6+luFkEOsmp5vD9I/7+" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.15/dist/contrib/auto-render.min.js" integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><!-- inline KaTeX --><script>
    function renderKaTeX() {
        if (typeof renderMathInElement !== "undefined") {
            renderMathInElement(document.body, {
                delimiters: [
                    { left: "$$", right: "$$", display: true },
                    { left: "$", right: "$", display: false },
                ],
            });
        }
    }

    document.addEventListener("DOMContentLoaded", renderKaTeX);
    document.addEventListener("astro:after-swap", renderKaTeX);
</script><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><script type="module" src="/_astro/ClientRouter.astro_astro_type_script_index_0_lang.BScVxmeO.js"></script><script>
    function init() {
        preloadTheme();
        onScroll();
        animate();
        updateThemeButtons();
        addCopyCodeButtons();
        setGiscusTheme();

        const backToTop = document.getElementById("back-to-top");
        backToTop?.addEventListener("click", (event) => scrollToTop(event));

        const backToPrev = document.getElementById("back-to-prev");
        backToPrev?.addEventListener("click", () => window.history.back());

        const lightThemeButton = document.getElementById("light-theme-button");
        lightThemeButton?.addEventListener("click", () => {
            localStorage.setItem("theme", "light");
            toggleTheme(false);
            updateThemeButtons();
        });

        const darkThemeButton = document.getElementById("dark-theme-button");
        darkThemeButton?.addEventListener("click", () => {
            localStorage.setItem("theme", "dark");
            toggleTheme(true);
            updateThemeButtons();
        });

        const systemThemeButton = document.getElementById(
            "system-theme-button",
        );
        systemThemeButton?.addEventListener("click", () => {
            localStorage.setItem("theme", "system");
            toggleTheme(
                window.matchMedia("(prefers-color-scheme: dark)").matches,
            );
            updateThemeButtons();
        });

        window
            .matchMedia("(prefers-color-scheme: dark)")
            .addEventListener("change", (event) => {
                if (localStorage.theme === "system") {
                    toggleTheme(event.matches);
                }
            });

        document.addEventListener("scroll", onScroll);
    }

    function updateThemeButtons() {
        const theme = localStorage.getItem("theme");
        const lightThemeButton = document.getElementById("light-theme-button");
        const darkThemeButton = document.getElementById("dark-theme-button");
        const systemThemeButton = document.getElementById(
            "system-theme-button",
        );

        function removeActiveButtonTheme(button) {
            button?.classList.remove("bg-black/5");
            button?.classList.remove("dark:bg-white/5");
        }

        function addActiveButtonTheme(button) {
            button?.classList.add("bg-black/5");
            button?.classList.add("dark:bg-white/5");
        }

        removeActiveButtonTheme(lightThemeButton);
        removeActiveButtonTheme(darkThemeButton);
        removeActiveButtonTheme(systemThemeButton);

        if (theme === "light") {
            addActiveButtonTheme(lightThemeButton);
        } else if (theme === "dark") {
            addActiveButtonTheme(darkThemeButton);
        } else {
            addActiveButtonTheme(systemThemeButton);
        }
    }

    function animate() {
        const animateElements = document.querySelectorAll(".animate");

        animateElements.forEach((element, index) => {
            setTimeout(() => {
                element.classList.add("show");
            }, index * 100);
        });
    }

    function onScroll() {
        if (window.scrollY > 0) {
            document.documentElement.classList.add("scrolled");
        } else {
            document.documentElement.classList.remove("scrolled");
        }
    }

    function scrollToTop(event) {
        event.preventDefault();
        window.scrollTo({
            top: 0,
            behavior: "smooth",
        });
    }

    function toggleTheme(dark) {
        const css = document.createElement("style");

        css.appendChild(
            document.createTextNode(
                `* {
             -webkit-transition: none !important;
             -moz-transition: none !important;
             -o-transition: none !important;
             -ms-transition: none !important;
             transition: none !important;
          }
        `,
            ),
        );

        document.head.appendChild(css);

        if (dark) {
            document.documentElement.classList.add("dark");
        } else {
            document.documentElement.classList.remove("dark");
        }

        window.getComputedStyle(css).opacity;
        document.head.removeChild(css);

        setGiscusTheme();
    }

    function preloadTheme() {
        const userTheme = localStorage.theme;

        if (userTheme === "light" || userTheme === "dark") {
            toggleTheme(userTheme === "dark");
        } else {
            toggleTheme(
                window.matchMedia("(prefers-color-scheme: dark)").matches,
            );
        }
    }

    function addCopyCodeButtons() {
        let copyButtonLabel = "📋";
        let codeBlocks = Array.from(document.querySelectorAll("pre"));

        async function copyCode(codeBlock, copyButton) {
            const codeText = codeBlock.innerText;
            const buttonText = copyButton.innerText;
            const textToCopy = codeText.replace(buttonText, "");

            await navigator.clipboard.writeText(textToCopy);
            copyButton.innerText = "✅";

            setTimeout(() => {
                copyButton.innerText = copyButtonLabel;
            }, 2000);
        }

        for (let codeBlock of codeBlocks) {
            const wrapper = document.createElement("div");
            wrapper.style.position = "relative";

            const copyButton = document.createElement("button");
            copyButton.innerText = copyButtonLabel;
            copyButton.classList = "copy-code";

            codeBlock.setAttribute("tabindex", "0");
            codeBlock.appendChild(copyButton);

            codeBlock.parentNode.insertBefore(wrapper, codeBlock);
            wrapper.appendChild(codeBlock);

            copyButton?.addEventListener("click", async () => {
                await copyCode(codeBlock, copyButton);
            });
        }
    }

    const setGiscusTheme = () => {
        const giscus = document.querySelector(".giscus-frame");

        const isDark = document.documentElement.classList.contains("dark");

        if (giscus) {
            const url = new URL(giscus.src);
            url.searchParams.set("theme", isDark ? "dark" : "light");
            giscus.src = url.toString();
        }
    };

    document.addEventListener("DOMContentLoaded", () => init());
    document.addEventListener("astro:after-swap", () => init());
    preloadTheme();
</script><link rel="stylesheet" href="/_astro/_subject_.BUximwJU.css">
<link rel="stylesheet" href="/_astro/index.C_mQFtof.css">
<style>summary[data-astro-cid-xvrfupwn]{cursor:pointer;border-top-left-radius:.5rem;border-top-right-radius:.5rem;padding:.375rem .75rem;font-weight:500;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}summary[data-astro-cid-xvrfupwn]:hover{background-color:#0000000d}summary[data-astro-cid-xvrfupwn]:hover:is(.dark *){background-color:#ffffff0d}details[data-astro-cid-xvrfupwn][open] summary[data-astro-cid-xvrfupwn]{background-color:#0000000d}details[data-astro-cid-xvrfupwn][open] summary[data-astro-cid-xvrfupwn]:is(.dark *){background-color:#ffffff0d}
[data-astro-image]{width:100%;height:auto;-o-object-fit:var(--fit);object-fit:var(--fit);-o-object-position:var(--pos);object-position:var(--pos);aspect-ratio:var(--w) / var(--h)}[data-astro-image=responsive]{max-width:calc(var(--w) * 1px);max-height:calc(var(--h) * 1px)}[data-astro-image=fixed]{width:calc(var(--w) * 1px);height:calc(var(--h) * 1px)}
</style></head> <body> <header data-astro-transition-persist="astro-l7r54iwe-1"> <div class="mx-auto max-w-screen-sm px-3"> <div class="flex flex-wrap justify-between gap-y-4"> <div class="flex flex-col gap-y-2"> <a href="/" target="_self" class="inline-block decoration-black/30 dark:decoration-white/30 hover:decoration-black/50 focus-visible:decoration-black/50 dark:hover:decoration-white/50 dark:focus-visible:decoration-white/50 text-current hover:text-black focus-visible:text-black dark:hover:text-white dark:focus-visible:text-white transition-colors duration-300 ease-in-out">  <div class="font-semibold"> rezarezvan.com </div>  </a> <div class="flex gap-x-2"> <button id="light-theme-button" aria-label="Light theme" class="group flex size-6 items-center justify-center rounded border border-black/15 hover:bg-black/5 focus-visible:bg-black/5 dark:border-white/20 dark:hover:bg-white/5 dark:focus-visible:bg-white/5"> <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="transition-colors duration-300 ease-in-out group-hover:animate-pulse group-hover:stroke-black group-focus-visible:animate-pulse group-focus-visible:stroke-black group-hover:dark:stroke-white dark:group-focus-visible:stroke-white"> <circle cx="12" cy="12" r="5"></circle> <line x1="12" y1="1" x2="12" y2="3"></line> <line x1="12" y1="21" x2="12" y2="23"></line> <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line> <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line> <line x1="1" y1="12" x2="3" y2="12"></line> <line x1="21" y1="12" x2="23" y2="12"></line> <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line> <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line> </svg> </button> <button id="dark-theme-button" aria-label="Dark theme" class="group flex size-6 items-center justify-center rounded border border-black/15 hover:bg-black/5 focus-visible:bg-black/5 dark:border-white/20 dark:hover:bg-white/5 dark:focus-visible:bg-white/5"> <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="transition-colors duration-300 ease-in-out group-hover:animate-pulse group-hover:stroke-black group-focus-visible:animate-pulse group-focus-visible:stroke-black group-hover:dark:stroke-white dark:group-focus-visible:stroke-white"> <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path> </svg> </button> <button id="system-theme-button" aria-label="System theme" class="group flex size-6 items-center justify-center rounded border border-black/15 hover:bg-black/5 focus-visible:bg-black/5 dark:border-white/20 dark:hover:bg-white/5 dark:focus-visible:bg-white/5"> <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="transition-colors duration-300 ease-in-out group-hover:animate-pulse group-hover:stroke-black group-focus-visible:animate-pulse group-focus-visible:stroke-black group-hover:dark:stroke-white dark:group-focus-visible:stroke-white"> <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect> <line x1="8" y1="21" x2="16" y2="21"></line> <line x1="12" y1="17" x2="12" y2="21"></line> </svg> </button> </div> </div> <nav class="flex items-center gap-1 text-sm"> <a href="/posts" target="_self" class="inline-block decoration-black/30 dark:decoration-white/30 hover:decoration-black/50 focus-visible:decoration-black/50 dark:hover:decoration-white/50 dark:focus-visible:decoration-white/50 text-current hover:text-black focus-visible:text-black dark:hover:text-white dark:focus-visible:text-white transition-colors duration-300 ease-in-out underline underline-offset-[3px]"> posts </a> <span>/</span> <a href="/chalmers" target="_self" class="inline-block decoration-black/30 dark:decoration-white/30 hover:decoration-black/50 focus-visible:decoration-black/50 dark:hover:decoration-white/50 dark:focus-visible:decoration-white/50 text-current hover:text-black focus-visible:text-black dark:hover:text-white dark:focus-visible:text-white transition-colors duration-300 ease-in-out underline underline-offset-[3px]"> chalmers </a> <span>/</span> <a href="/cityu" target="_self" class="inline-block decoration-black/30 dark:decoration-white/30 hover:decoration-black/50 focus-visible:decoration-black/50 dark:hover:decoration-white/50 dark:focus-visible:decoration-white/50 text-current hover:text-black focus-visible:text-black dark:hover:text-white dark:focus-visible:text-white transition-colors duration-300 ease-in-out underline underline-offset-[3px]"> cityu </a> <span>/</span> <a href="/pdf/cv/cv.pdf" target="_self" class="inline-block decoration-black/30 dark:decoration-white/30 hover:decoration-black/50 focus-visible:decoration-black/50 dark:hover:decoration-white/50 dark:focus-visible:decoration-white/50 text-current hover:text-black focus-visible:text-black dark:hover:text-white dark:focus-visible:text-white transition-colors duration-300 ease-in-out underline underline-offset-[3px]"> cv </a> <span>/</span> <button id="magnifying-glass" aria-label="Search" class="flex items-center rounded border border-black/15 bg-neutral-100 px-2 py-1 text-xs transition-colors duration-300 ease-in-out hover:bg-black/5 hover:text-black focus-visible:bg-black/5 focus-visible:text-black dark:border-white/20 dark:bg-neutral-900 dark:hover:bg-white/5 dark:hover:text-white dark:focus-visible:bg-white/5 dark:focus-visible:text-white"> <svg height="16" stroke-linejoin="round" viewBox="0 0 16 16" width="16" style="color: currentcolor;"> <path fill-rule="evenodd" clip-rule="evenodd" d="M3.5 7C3.5 5.067 5.067 3.5 7 3.5C8.933 3.5 10.5 5.067 10.5 7C10.5 7.88461 10.1718 8.69256 9.63058 9.30876L9.30876 9.63058C8.69256 10.1718 7.88461 10.5 7 10.5C5.067 10.5 3.5 8.933 3.5 7ZM9.96544 11.0261C9.13578 11.6382 8.11014 12 7 12C4.23858 12 2 9.76142 2 7C2 4.23858 4.23858 2 7 2C9.76142 2 12 4.23858 12 7C12 8.11014 11.6382 9.13578 11.0261 9.96544L14.0303 12.9697L14.5607 13.5L13.5 14.5607L12.9697 14.0303L9.96544 11.0261Z" fill="currentColor"></path> </svg>
&nbsp;Search
</button> </nav> </div> </div> </header> <main>  <div class="mx-auto max-w-screen-sm px-3"> <div class="animate grid gap-4"> <a href="/cityu/ma3518" class="not-prose group relative flex w-fit flex-nowrap rounded border border-black/15 py-1.5 pl-7 pr-3 transition-colors duration-300 ease-in-out hover:bg-black/5 hover:text-black focus-visible:bg-black/5 focus-visible:text-black dark:border-white/20 dark:hover:bg-white/5 dark:hover:text-white dark:focus-visible:bg-white/5 dark:focus-visible:text-white"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="absolute left-2 top-1/2 size-4 -translate-y-1/2 fill-none stroke-current stroke-2"> <line x1="5" y1="12" x2="19" y2="12" class="translate-x-2 scale-x-0 transition-transform duration-300 ease-in-out group-hover:translate-x-0 group-hover:scale-x-100 group-focus-visible:translate-x-0 group-focus-visible:scale-x-100"></line> <polyline points="12 5 5 12 12 19" class="translate-x-1 transition-transform duration-300 ease-in-out group-hover:translate-x-0 group-focus-visible:translate-x-0"></polyline> </svg> <div class="text-sm"> 
Back to applied statistics </div> </a> <div class="grid grid-cols-2 gap-1.5 sm:gap-3"> <a href="/cityu/ma3518/ma3518_4" class="group relative flex flex-nowrap rounded-lg border border-black/15 px-4 py-3 pl-10 no-underline transition-colors duration-300 ease-in-out hover:bg-black/5 hover:text-black focus-visible:bg-black/5 focus-visible:text-black dark:border-white/20 dark:hover:bg-white/5 dark:hover:text-white dark:focus-visible:bg-white/5 dark:focus-visible:text-white"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="absolute left-2 top-1/2 size-5 -translate-y-1/2 fill-none stroke-current stroke-2"> <line x1="5" y1="12" x2="19" y2="12" class="translate-x-3 scale-x-0 transition-transform duration-300 ease-in-out group-hover:translate-x-0 group-hover:scale-x-100 group-focus-visible:translate-x-0 group-focus-visible:scale-x-100"></line> <polyline points="12 5 5 12 12 19" class="translate-x-1 transition-transform duration-300 ease-in-out group-hover:translate-x-0 group-focus-visible:translate-x-0"></polyline> </svg> <div class="flex items-center text-sm"> Part 4 - Simple Linear Regression </div> </a> <div class="invisible"></div> </div> </div> <div class="my-10 space-y-1"> <div class="animate flex items-center gap-1.5"> <div class="font-base text-sm">MA3518</div>
&bull;
<div class="font-base text-sm"> <time datetime="2024-11-21T00:00:00.000Z"> November 21, 2024 </time> </div> 
&bull;
<div class="font-base text-sm">
Last modified:  <time datetime="2024-11-25T10:10:11.000Z"> November 25, 2024 </time> </div> 
&bull;
<div class="font-base text-sm">13 min read</div> </div> <h1 class="animate text-3xl font-semibold text-black dark:text-white"> Part 5 - Multiple Linear Regression </h1> </div> <details open class="animate rounded-lg border border-black/15 dark:border-white/20" data-astro-cid-xvrfupwn> <summary data-astro-cid-xvrfupwn>Table of Contents</summary> <nav class="" data-astro-cid-xvrfupwn> <ul class="py-3" data-astro-cid-xvrfupwn> <li class="list-inside list-disc px-6 py-1.5 text-sm"> <a href="#introduction" target="_self" class="inline-block decoration-black/30 dark:decoration-white/30 hover:decoration-black/50 focus-visible:decoration-black/50 dark:hover:decoration-white/50 dark:focus-visible:decoration-white/50 text-current hover:text-black focus-visible:text-black dark:hover:text-white dark:focus-visible:text-white transition-colors duration-300 ease-in-out underline underline-offset-[3px]"> Introduction </a> <ul class="translate-x-3"> <li class="list-inside list-disc px-6 py-1.5 text-sm"> <a href="#matrix-form" target="_self" class="inline-block decoration-black/30 dark:decoration-white/30 hover:decoration-black/50 focus-visible:decoration-black/50 dark:hover:decoration-white/50 dark:focus-visible:decoration-white/50 text-current hover:text-black focus-visible:text-black dark:hover:text-white dark:focus-visible:text-white transition-colors duration-300 ease-in-out underline underline-offset-[3px]"> Matrix Form </a>  </li> </ul> </li><li class="list-inside list-disc px-6 py-1.5 text-sm"> <a href="#inference" target="_self" class="inline-block decoration-black/30 dark:decoration-white/30 hover:decoration-black/50 focus-visible:decoration-black/50 dark:hover:decoration-white/50 dark:focus-visible:decoration-white/50 text-current hover:text-black focus-visible:text-black dark:hover:text-white dark:focus-visible:text-white transition-colors duration-300 ease-in-out underline underline-offset-[3px]"> Inference </a> <ul class="translate-x-3"> <li class="list-inside list-disc px-6 py-1.5 text-sm"> <a href="#example" target="_self" class="inline-block decoration-black/30 dark:decoration-white/30 hover:decoration-black/50 focus-visible:decoration-black/50 dark:hover:decoration-white/50 dark:focus-visible:decoration-white/50 text-current hover:text-black focus-visible:text-black dark:hover:text-white dark:focus-visible:text-white transition-colors duration-300 ease-in-out underline underline-offset-[3px]"> Example </a>  </li> </ul> </li><li class="list-inside list-disc px-6 py-1.5 text-sm"> <a href="#interaction-effects" target="_self" class="inline-block decoration-black/30 dark:decoration-white/30 hover:decoration-black/50 focus-visible:decoration-black/50 dark:hover:decoration-white/50 dark:focus-visible:decoration-white/50 text-current hover:text-black focus-visible:text-black dark:hover:text-white dark:focus-visible:text-white transition-colors duration-300 ease-in-out underline underline-offset-[3px]"> Interaction Effects </a>  </li><li class="list-inside list-disc px-6 py-1.5 text-sm"> <a href="#diagnostics-summary" target="_self" class="inline-block decoration-black/30 dark:decoration-white/30 hover:decoration-black/50 focus-visible:decoration-black/50 dark:hover:decoration-white/50 dark:focus-visible:decoration-white/50 text-current hover:text-black focus-visible:text-black dark:hover:text-white dark:focus-visible:text-white transition-colors duration-300 ease-in-out underline underline-offset-[3px]"> Diagnostics Summary </a> <ul class="translate-x-3"> <li class="list-inside list-disc px-6 py-1.5 text-sm"> <a href="#leverage-points-and-residuals" target="_self" class="inline-block decoration-black/30 dark:decoration-white/30 hover:decoration-black/50 focus-visible:decoration-black/50 dark:hover:decoration-white/50 dark:focus-visible:decoration-white/50 text-current hover:text-black focus-visible:text-black dark:hover:text-white dark:focus-visible:text-white transition-colors duration-300 ease-in-out underline underline-offset-[3px]"> Leverage Points and Residuals </a>  </li><li class="list-inside list-disc px-6 py-1.5 text-sm"> <a href="#added-variable-plots" target="_self" class="inline-block decoration-black/30 dark:decoration-white/30 hover:decoration-black/50 focus-visible:decoration-black/50 dark:hover:decoration-white/50 dark:focus-visible:decoration-white/50 text-current hover:text-black focus-visible:text-black dark:hover:text-white dark:focus-visible:text-white transition-colors duration-300 ease-in-out underline underline-offset-[3px]"> Added Variable Plots </a>  </li><li class="list-inside list-disc px-6 py-1.5 text-sm"> <a href="#transformations" target="_self" class="inline-block decoration-black/30 dark:decoration-white/30 hover:decoration-black/50 focus-visible:decoration-black/50 dark:hover:decoration-white/50 dark:focus-visible:decoration-white/50 text-current hover:text-black focus-visible:text-black dark:hover:text-white dark:focus-visible:text-white transition-colors duration-300 ease-in-out underline underline-offset-[3px]"> Transformations </a> <ul class="translate-x-3"> <li class="list-inside list-disc px-6 py-1.5 text-sm"> <a href="#example-defective-rates" target="_self" class="inline-block decoration-black/30 dark:decoration-white/30 hover:decoration-black/50 focus-visible:decoration-black/50 dark:hover:decoration-white/50 dark:focus-visible:decoration-white/50 text-current hover:text-black focus-visible:text-black dark:hover:text-white dark:focus-visible:text-white transition-colors duration-300 ease-in-out underline underline-offset-[3px]"> Example: Defective rates. </a>  </li> </ul> </li><li class="list-inside list-disc px-6 py-1.5 text-sm"> <a href="#collinearity-of-predictors" target="_self" class="inline-block decoration-black/30 dark:decoration-white/30 hover:decoration-black/50 focus-visible:decoration-black/50 dark:hover:decoration-white/50 dark:focus-visible:decoration-white/50 text-current hover:text-black focus-visible:text-black dark:hover:text-white dark:focus-visible:text-white transition-colors duration-300 ease-in-out underline underline-offset-[3px]"> Collinearity of Predictors </a>  </li> </ul> </li> </ul> </nav> </details> <article class="animate"> <h3 id="introduction">Introduction</h3>
<p>Last time we discussed simple linear regression, which is a model that predicts the value of a dependent variable based on the value of a single independent variable.
But, often in the real world, we may want to model our dependant variable from multiple independent variables.</p>
<p>Or, mathematically represented as,</p>
<p>$$
Y_i = \beta_0 + \beta_1 x_{1i} 0 \beta_2 x_{2i} + \ldots + \beta_p x_{pi} + e_i
$$</p>
<p>To have a “good” fit, we try to minimize RSS, however, since we now have multiple variables, we need to minimize the RSS with respect to all the variables.</p>
<p>$$
\begin{align*}
RSS &#x26;= \sum_{i=1}^{n} (y_i - b_0 - b_1 - \ldots - b_p x_{pi})^2 \newline
&#x26;= \frac{\partial RSS}{\partial b_0} = -2 \sum_{i=1}^{n} (y_i - b_0 - b_1 x_{1i} - b_2 x_{2i} - \ldots - b_p x_{pi}) = 0 \newline
&#x26;= \frac{\partial RSS}{\partial b_1} = -2 \sum_{i=1}^{n} x_{1i} (y_i - b_0 - b_1 x_{1i} - b_2 x_{2i} - \ldots - b_p x_{pi}) = 0 \newline
&#x26; \vdots \newline
&#x26;= \frac{\partial RSS}{\partial b_p} = -2 \sum_{i=1}^{n} x_{pi} (y_i - b_0 - b_1 x_{1i} - b_2 x_{2i} - \ldots - b_p x_{pi}) = 0 \newline
\end{align*}
$$</p>
<h4 id="matrix-form">Matrix Form</h4>
<p>Using matrix formulation is more convenient,</p>
<p>$$
\mathbf{Y} =
\begin{bmatrix}
y_1 \newline
y_2 \newline
\vdots \newline
y_n
\end{bmatrix},
\mathbf{X} =
\begin{bmatrix}
1 &#x26; x_{11} &#x26; \ldots &#x26; x_{1p} \newline
1 &#x26; x_{21} &#x26; \ldots &#x26; x_{2p} \newline
\vdots &#x26; \vdots &#x26; \ddots &#x26; \vdots \newline
1 &#x26; x_{n1} &#x26; \ldots &#x26; x_{np}
\end{bmatrix},
\beta =
\begin{bmatrix}
\beta_0 \newline
\beta_1 \newline
\vdots \newline
\beta_p
\end{bmatrix},
\mathbf{e} =
\begin{bmatrix}
e_1 \newline
e_2 \newline
\vdots \newline
e_n
\end{bmatrix}
$$</p>
<p>Thus, the matrix form of the equation is,</p>
<p>$$
\mathbf{Y} = \mathbf{X} \beta + \mathbf{e}
$$</p>
<p>Now, we can write the RSS, denoted as $RSS(\beta)$, in matrix form as,</p>
<p>$$
RSS(\beta) = (\mathbf{Y} - \mathbf{X} \beta)^T (\mathbf{Y} - \mathbf{X} \beta)
$$</p>
<p>We can also write our predictor for $\hat{\beta}$ as,</p>
<p>$$
\hat{\beta} = (\mathbf{X}^T \mathbf{X})^{-1} \mathbf{X}^T \mathbf{Y}
$$</p>
<p>Since we are trying to generalize linear regression with this, it must mean that simple linear regression is a special case of multiple linear.</p>
<p>$$
\mathbf{X}^T \mathbf{X} =
\begin{bmatrix}
1 &#x26; 1 &#x26; \ldots &#x26; 1 \newline
x_1 &#x26; x_2 &#x26; \ldots &#x26; x_n
\end{bmatrix}
\begin{bmatrix}
1 &#x26; x_1 \newline
1 &#x26; x_2 \newline
\vdots &#x26; \vdots \newline
1 &#x26; x_n
\end{bmatrix} =
\begin{bmatrix}
n &#x26; \sum_{i=1}^{n} x_i \newline
\sum_{i=1}^{n} x_i &#x26; \sum_{i=1}^{n} x_i^2
\end{bmatrix} = n
\begin{bmatrix}
1 &#x26; \bar{x} \newline
\bar{x} &#x26; \frac{1}{n} \sum_{i=1}^{n} x_i^2
\end{bmatrix}
$$</p>
<p>The inverse of this matrix is,
$$
(\mathbf{X}^T \mathbf{X})^{-1} = \frac{1}{n \left( \frac{1}{n} \sum_{i=1}^{n} x_i^2 - \bar{x}^2 \right)}
\begin{bmatrix}
\frac{1}{n} \sum_{i=1}^{n} x_i^2 &#x26; -\bar{x} \newline
-\bar{x} &#x26; 1
\end{bmatrix} =
\frac{1}{S_{xx}}
\begin{bmatrix}
\frac{1}{n} \sum_{i=1}^{n} x_i^2 &#x26; -\bar{x} \newline
-\bar{x} &#x26; 1
\end{bmatrix}
$$</p>
<p>$$
\mathbf{X}^T \mathbf{Y} =
\begin{bmatrix}
1 &#x26; 1 &#x26; \ldots &#x26; 1 \newline
x_1 &#x26; x_2 &#x26; \ldots &#x26; x_n
\end{bmatrix}
\begin{bmatrix}
y_1 \newline
y_2 \newline
\vdots \newline
y_n
\end{bmatrix} =
\begin{bmatrix}
\sum_{i=1}^{n} y_i \newline
\sum_{i=1}^{n} x_i y_i
\end{bmatrix}
$$</p>
<p>Which finally means that $\hat{\beta}$ is,</p>
<p>$$
\begin{align*}
\hat{\beta} &#x26;= \frac{1}{S_{xx}}
\begin{bmatrix}
\frac{1}{n} \sum_{i=1}^{n} x_i^2 &#x26; -\bar{x} \newline
-\bar{x} &#x26; 1
\end{bmatrix}
\begin{bmatrix}
\sum_{i=1}^{n} y_i \newline
\sum_{i=1}^{n} x_i y_i
\end{bmatrix} \newline
&#x26;= \frac{1}{S_{xx}}
\begin{bmatrix}
\frac{1}{n} \sum_{i=1}^{n} y_i \sum_{i=1}^{n} x_i^2 - \bar{x} \sum_{i=1}^{n} x_i y_i \newline
\sum_{i=1}^{n} x_i y_i - \bar{x} \sum_{i=1}^{n} y_i
\end{bmatrix} \newline
&#x26;=
\begin{bmatrix}
\frac{\bar{y} \left[ \sum_{i=1}^n x_i^2 - n\bar{x}^2 \right] - \bar{x} \left[ \sum_{i=1}^n x_i y_i - n\bar{x}\bar{y} \right]}{S_{xx}} \newline
\frac{S_{xy}}{S_{xx}}
\end{bmatrix} \newline
&#x26;=
\begin{bmatrix}
\bar{y} - \frac{S_{xy}}{S_{xx}} \bar{x} \newline
\frac{S_{xy}}{S_{xx}}
\end{bmatrix}
\end{align*}
$$</p>
<p>So we finally have our $\beta_0$ and $\beta_1$.</p>
<p>Let’s take a look at some properties of the multiple linear regression model.</p>
<p>$$
\begin{align*}
\mathbb{E}(\hat{\beta} | \mathbf{X}) &#x26;= \beta \newline
\text{Var}(\hat{\beta} | \mathbf{X}) &#x26;= \sigma^2 (\mathbf{X}^T \mathbf{X})^{-1}
S^2 &#x26;= \frac{RSS}{n-p-1} = \frac{\sum_{i=1}^{n} \hat{e}_i^2}{n-p-1}
\end{align*}
$$</p>
<h3 id="inference">Inference</h3>
<p>We can define inference for a <em>single</em> parameter as such,</p>
<p>$$
T_i = \frac{\hat{\beta_i} - \beta_i}{SE(\hat{\beta_i})} \sim t_{n-p-1}
$$</p>
<p>Analysis of variance approach to inference is also possible,</p>
<p>$$
H_0 : \beta_1 = \ldots = \beta_p = 0 \newline
H_1 : \text{At least one } \beta_j \neq 0
$$</p>
<p>Let’s recall some important definitions,</p>
<p>$$
\begin{align*}
SST = S_{yy} &#x26;= \sum_{i=1}^{n} (y_i - \bar{y})^2 \newline
RSS = &#x26;= \sum_{i=1}^{n} (y_i - \hat{y_i})^2 \newline
SS_{\text{reg}} &#x26;= \sum_{i=1}^{n} (\hat{y_i} - \bar{y})^2
SST = SS_{\text{reg}} + RSS
\end{align*}
$$</p>
<p>The test statistic is defined as,</p>
<p>$$
F = \frac{SS_{reg}/p}{RSS/(n-p-1)} \sim F_{p, n-p-1}
$$</p>
<p>where we reject $H_0$ if $F$ is too large.</p>
<p>Recall our analysis of variance table,</p>

































<table><thead><tr><th>Source of Variation</th><th>Degrees of Freedom (df)</th><th>Sum of Squares (SS)</th><th>Mean Square (MS)</th><th>F-statistic</th></tr></thead><tbody><tr><td>Regression</td><td>p</td><td>$SS_{\text{reg}}$</td><td>$SS_{\text{reg}}/p$</td><td>$F = \frac{SS_{\text{reg}}/p}{RSS/(n - p - 1)}$</td></tr><tr><td>Residual</td><td>$n - p - 1$</td><td>$RSS$</td><td>$S^2 = \frac{RSS}{n - p - 1}$</td><td></td></tr><tr><td>Total</td><td>$n - 1$</td><td>$SST = S_{yy}$</td><td></td><td></td></tr></tbody></table>
<p>The coefficient of determination and adjusted coefficient of determination are defined as,</p>
<p>$$
\begin{align*}
R^2 &#x26;= \frac{SS_{\text{reg}}}{SST} = 1 - \frac{RSS}{SST} \newline
R^2_{\text{adj}} &#x26;= 1 - \frac{RSS/(n-p-1)}{SST/(n-1)}
\end{align*}
$$</p>
<p>This new adjusted coefficient of determination is due to the fact of, if we add variables (even irrelevant variables) $R^2$ never decreases.
Thus to compare the model with different number of variables, we use this.</p>
<p>We can also test a <em>subset</em> of coefficients using ANOVA.</p>
<p>$$
H_0 : \beta_1 = \ldots = \beta_k = 0 \newline
H_1 : \text{At least one } \beta_j \neq 0
$$</p>
<p>Then the test statistic is,</p>
<p>$$
\begin{align*}
F &#x26;= \frac{(RSS(\text{reduced} - RSS(\text{full}))/(df_{\text{reduced}} - df_{\text{full}})}{RSS(\text{full})/df_{\text{full}}} \newline
&#x26;= \frac{(RSS(\text{reduced} - RSS(\text{full}))/k}{RSS(\text{full})/(n-p-1)}
\end{align*}
$$</p>
<p>since $df_{\text{reduced}} - df_{\text{full}} = (n - (p + 1 - k) - (n - (p + 1)) = k$.</p>
<h4 id="example">Example</h4>
<p>Let’s look at a simple example and the corresponding R code.</p>
<blockquote>
<p>Data from surveys of customers of 168 Italian restaurants in the target area are available, with the following variables:
$$
\begin{align*}
Y &#x26;= \text{Price} = \text{the price (in \$US) of a dinner (including 1 drink \&#x26; a tip)} \newline
x_1 &#x26;= \text{Food} = \text{customer rating of the food (out of 30)} \newline
x_2 &#x26;= \text{Décor} = \text{customer rating of the decor (out of 30)} \newline
x_3 &#x26;= \text{Service} = \text{customer rating of the service (out of 30)} \newline
x_4 &#x26;= \text{East} = \text{dummy variable} = 1 \text{ if the restaurant is east of Fifth Avenue, 0 if it is west}
\end{align*}
$$</p>
</blockquote>
<p>So, let’s first devlop a regression model that <em>predicts</em> the price of a dinner.</p>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-background);color:var(--astro-code-foreground); overflow-x: auto;" tabindex="0" data-language="r"><code><span class="line"><span style="color:var(--astro-code-token-comment)"># Assume data is loaded into `nyc`.</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">attach</span><span style="color:var(--astro-code-foreground)">(nyc)</span></span>
<span class="line"><span style="color:var(--astro-code-foreground)">m1</span><span style="color:var(--astro-code-token-keyword)">&#x3C;-</span><span style="color:var(--astro-code-token-function)">lm</span><span style="color:var(--astro-code-foreground)">(Price</span><span style="color:var(--astro-code-token-keyword)">~</span><span style="color:var(--astro-code-foreground)">Food</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-foreground)">Decor</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-foreground)">Service</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-foreground)">East)</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">summary</span><span style="color:var(--astro-code-foreground)">(m1)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-foreground)"> Coefficients</span><span style="color:var(--astro-code-token-keyword)">:</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-foreground)">             Estimate Std. Error t value </span><span style="color:var(--astro-code-token-function)">Pr(</span><span style="color:var(--astro-code-token-keyword)">>|</span><span style="color:var(--astro-code-token-punctuation)">t</span><span style="color:var(--astro-code-token-keyword)">|</span><span style="color:var(--astro-code-token-function)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-foreground)"> (Intercept)  </span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-token-constant)">24.244248</span><span style="color:var(--astro-code-token-constant)">   4.758009</span><span style="color:var(--astro-code-token-keyword)">  -</span><span style="color:var(--astro-code-token-constant)">5.095</span><span style="color:var(--astro-code-token-constant)"> 9.70e-07</span><span style="color:var(--astro-code-token-keyword)"> ***</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-foreground)"> Food          </span><span style="color:var(--astro-code-token-constant)">1.553922</span><span style="color:var(--astro-code-token-constant)">   0.372672</span><span style="color:var(--astro-code-token-constant)">   4.170</span><span style="color:var(--astro-code-token-constant)"> 4.98e-05</span><span style="color:var(--astro-code-token-keyword)"> ***</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-foreground)"> Decor         </span><span style="color:var(--astro-code-token-constant)">1.897926</span><span style="color:var(--astro-code-token-constant)">   0.219100</span><span style="color:var(--astro-code-token-constant)">   8.662</span><span style="color:var(--astro-code-token-constant)"> 4.79e-15</span><span style="color:var(--astro-code-token-keyword)"> ***</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-foreground)"> Service       </span><span style="color:var(--astro-code-token-constant)">0.005318</span><span style="color:var(--astro-code-token-constant)">   0.399493</span><span style="color:var(--astro-code-token-constant)">   0.013</span><span style="color:var(--astro-code-token-constant)"> 0.9894</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-foreground)"> East          </span><span style="color:var(--astro-code-token-constant)">2.003432</span><span style="color:var(--astro-code-token-constant)">   0.961794</span><span style="color:var(--astro-code-token-constant)">   2.083</span><span style="color:var(--astro-code-token-constant)"> 0.0388</span><span style="color:var(--astro-code-token-keyword)"> *</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-token-keyword)"> ---</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-foreground)"> Signif. codes</span><span style="color:var(--astro-code-token-keyword)">:</span><span style="color:var(--astro-code-token-constant)">  0</span><span style="color:var(--astro-code-foreground)"> ‘</span><span style="color:var(--astro-code-token-keyword)">***</span><span style="color:var(--astro-code-foreground)">’ </span><span style="color:var(--astro-code-token-constant)">0.001</span><span style="color:var(--astro-code-foreground)"> ‘</span><span style="color:var(--astro-code-token-keyword)">**</span><span style="color:var(--astro-code-foreground)">’ </span><span style="color:var(--astro-code-token-constant)">0.01</span><span style="color:var(--astro-code-foreground)"> ‘</span><span style="color:var(--astro-code-token-keyword)">*</span><span style="color:var(--astro-code-foreground)">’ </span><span style="color:var(--astro-code-token-constant)">0.05</span><span style="color:var(--astro-code-foreground)"> ‘.’ </span><span style="color:var(--astro-code-token-constant)">0.1</span><span style="color:var(--astro-code-foreground)"> ‘ ’ </span><span style="color:var(--astro-code-token-constant)">1</span></span></code></pre>
<p>So, our initial regression model is,</p>
<p>$$
\text{Price} = -24.244248 + 1.553922 \text{Food} + 1.897926 \text{Decor} + 0.005318 \text{Service} + 2.003432 \text{East}
$$</p>
<p>We can see that Décor has the largest effect on the price (note that Food, Décor and Service are each measured on the same 0 to 30 scale so it is meaningful to compare the regression coefficients).</p>
<p>We can also observe that, if a new resturant wants to choose a location, it should be east of Fifth Avenue, since our dummy variable is statistically significantly larger than 0.</p>
<h3 id="interaction-effects">Interaction Effects</h3>
<p>Consider we want to model $Y$ based on a continuous predictor $x$ and a dummy variable $d$.
Compared to using a single variable $x$, the additional effect of $d$ could be,</p>
<ol>
<li>$d$ ahs no effect on $Y$, that is, $Y = \beta_0 + \beta_1 x + e$.</li>
<li>$d$ produces only an additive change in $Y$, that is,
$$
Y = \beta_0 + \beta_1 x + \beta_2 d + e =
\begin{cases}
\beta_0 + \beta_1 x + e &#x26; d = 0 \newline
\beta_0 + \beta_2 + \beta_1 x + e &#x26; d = 1
\end{cases}
$$</li>
<li>$d$ produces an additive change in $Y$ and also changes the size of the effect of $x$ on $Y$, that is,
$$
Y = \beta_0 + \beta_1 x + \beta_2 d + \beta_3 xd + e =
\begin{cases}
\beta_0 + \beta_1 x + e &#x26; d = 0 \newline
\beta_0 + \beta_2 + (\beta_1  + \beta_3) x + e &#x26; d = 1
\end{cases}
$$</li>
</ol>
<p>Let’s go back to our example again.</p>
<blockquote>
<p>After you present your model to the management team, the debate foucses on the statistical insignificane of the Service variable.
The team feels like the model may be too simple to reflect the reality of a Italian restaurant in Manhattan.
In particular, there is general consensus amongst the team that restaurants on the east of Fifth Avenue are very different from those on the west side.
As such, you have been asked to consider different models for the East and West.</p>
</blockquote>
<p>So, we can develop a mathematical model as such,</p>
<p>$$
Y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_3 + \beta_4 \text{East} + \beta_5 x_1 \text{East} + \beta_6 x_2 \text{East} + \beta_7 x_3 \text{East} + e
$$</p>
<p>In our code now,</p>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-background);color:var(--astro-code-foreground); overflow-x: auto;" tabindex="0" data-language="r"><code><span class="line"><span style="color:var(--astro-code-foreground)">m2</span><span style="color:var(--astro-code-token-keyword)">&#x3C;-</span><span style="color:var(--astro-code-token-function)">lm</span><span style="color:var(--astro-code-foreground)">(Price</span><span style="color:var(--astro-code-token-keyword)">~</span><span style="color:var(--astro-code-foreground)">Food</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-foreground)">Decor</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-foreground)">Service</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-foreground)">East</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-foreground)">Food</span><span style="color:var(--astro-code-token-keyword)">:</span><span style="color:var(--astro-code-foreground)">East</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-foreground)">Decor</span><span style="color:var(--astro-code-token-keyword)">:</span><span style="color:var(--astro-code-foreground)">East</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-foreground)">Serivce</span><span style="color:var(--astro-code-token-keyword)">:</span><span style="color:var(--astro-code-foreground)">East)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-foreground)"> Coefficients</span><span style="color:var(--astro-code-token-keyword)">:</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-foreground)">             Estimate Std. Error t value </span><span style="color:var(--astro-code-token-function)">Pr(</span><span style="color:var(--astro-code-token-keyword)">>|</span><span style="color:var(--astro-code-token-punctuation)">t</span><span style="color:var(--astro-code-token-keyword)">|</span><span style="color:var(--astro-code-token-function)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-foreground)"> (Intercept) </span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-token-constant)">26.9305</span><span style="color:var(--astro-code-token-constant)">   8.5195</span><span style="color:var(--astro-code-token-keyword)">  -</span><span style="color:var(--astro-code-token-constant)">3.161</span><span style="color:var(--astro-code-token-constant)"> 0.00189</span><span style="color:var(--astro-code-token-keyword)"> **</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-foreground)"> Food          </span><span style="color:var(--astro-code-token-constant)">0.9986</span><span style="color:var(--astro-code-token-constant)">   0.5742</span><span style="color:var(--astro-code-token-constant)">   1.739</span><span style="color:var(--astro-code-token-constant)"> 0.08398</span><span style="color:var(--astro-code-foreground)"> .</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-foreground)"> Decor         </span><span style="color:var(--astro-code-token-constant)">1.8824</span><span style="color:var(--astro-code-token-constant)">   0.3005</span><span style="color:var(--astro-code-token-constant)">   6.264</span><span style="color:var(--astro-code-token-constant)"> 3.45e-09</span><span style="color:var(--astro-code-token-keyword)"> ***</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-foreground)"> Service       </span><span style="color:var(--astro-code-token-constant)">0.7566</span><span style="color:var(--astro-code-token-constant)">   0.6489</span><span style="color:var(--astro-code-token-constant)">   1.166</span><span style="color:var(--astro-code-token-constant)"> 0.24536</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-foreground)"> East          </span><span style="color:var(--astro-code-token-constant)">5.5702</span><span style="color:var(--astro-code-token-constant)">  10.3285</span><span style="color:var(--astro-code-token-constant)">   0.539</span><span style="color:var(--astro-code-token-constant)"> 0.59044</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-foreground)"> Food</span><span style="color:var(--astro-code-token-keyword)">:</span><span style="color:var(--astro-code-foreground)">East     </span><span style="color:var(--astro-code-token-constant)">1.2679</span><span style="color:var(--astro-code-token-constant)">   0.7815</span><span style="color:var(--astro-code-token-constant)">   1.622</span><span style="color:var(--astro-code-token-constant)"> 0.10673</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-foreground)"> Decor</span><span style="color:var(--astro-code-token-keyword)">:</span><span style="color:var(--astro-code-foreground)">East   </span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-token-constant)">0.2791</span><span style="color:var(--astro-code-token-constant)">   0.4618</span><span style="color:var(--astro-code-token-keyword)">  -</span><span style="color:var(--astro-code-token-constant)">0.604</span><span style="color:var(--astro-code-token-constant)"> 0.54646</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-foreground)"> Service</span><span style="color:var(--astro-code-token-keyword)">:</span><span style="color:var(--astro-code-foreground)">East </span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-token-constant)">1.2842</span><span style="color:var(--astro-code-token-constant)">   0.8230</span><span style="color:var(--astro-code-token-keyword)">  -</span><span style="color:var(--astro-code-token-constant)">1.560</span><span style="color:var(--astro-code-token-constant)"> 0.12071</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-foreground)"> Residual standard error</span><span style="color:var(--astro-code-token-keyword)">:</span><span style="color:var(--astro-code-token-constant)"> 5.747</span><span style="color:var(--astro-code-foreground)"> on </span><span style="color:var(--astro-code-token-constant)">157</span><span style="color:var(--astro-code-foreground)"> degrees of freedom</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-foreground)"> (</span><span style="color:var(--astro-code-token-constant)">3</span><span style="color:var(--astro-code-foreground)"> observations deleted due to missingness)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-foreground)"> Multiple R</span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-foreground)">squared</span><span style="color:var(--astro-code-token-keyword)">:</span><span style="color:var(--astro-code-token-constant)"> 0.6381</span><span style="color:var(--astro-code-foreground)">, Adjusted R</span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-foreground)">squared</span><span style="color:var(--astro-code-token-keyword)">:</span><span style="color:var(--astro-code-token-constant)"> 0.622</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-foreground)"> F</span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-foreground)">statistic</span><span style="color:var(--astro-code-token-keyword)">:</span><span style="color:var(--astro-code-token-constant)"> 39.55</span><span style="color:var(--astro-code-foreground)"> on </span><span style="color:var(--astro-code-token-constant)">7</span><span style="color:var(--astro-code-foreground)"> and </span><span style="color:var(--astro-code-token-constant)">157</span><span style="color:var(--astro-code-foreground)"> DF, p</span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-foreground)">value</span><span style="color:var(--astro-code-token-keyword)">:</span><span style="color:var(--astro-code-token-keyword)"> &#x3C;</span><span style="color:var(--astro-code-token-constant)"> 2.2e-16</span></span></code></pre>
<p>If we also do an ANOVA test,</p>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-background);color:var(--astro-code-foreground); overflow-x: auto;" tabindex="0" data-language="r"><code><span class="line"><span style="color:var(--astro-code-token-function)">anova</span><span style="color:var(--astro-code-foreground)">(m1, m2)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-foreground)"> Analysis of Variance Table</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-foreground)"> Model </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-keyword)">:</span><span style="color:var(--astro-code-foreground)"> Price </span><span style="color:var(--astro-code-token-keyword)">~</span><span style="color:var(--astro-code-foreground)"> Food </span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-foreground)"> Decor </span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-foreground)"> East</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-foreground)"> Model </span><span style="color:var(--astro-code-token-constant)">2</span><span style="color:var(--astro-code-token-keyword)">:</span><span style="color:var(--astro-code-foreground)"> Price </span><span style="color:var(--astro-code-token-keyword)">~</span><span style="color:var(--astro-code-foreground)"> Food </span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-foreground)"> Decor </span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-foreground)"> Service </span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-foreground)"> East </span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-foreground)"> Food</span><span style="color:var(--astro-code-token-keyword)">:</span><span style="color:var(--astro-code-foreground)">East </span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-foreground)"> Decor</span><span style="color:var(--astro-code-token-keyword)">:</span><span style="color:var(--astro-code-foreground)">East </span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-foreground)"> Service</span><span style="color:var(--astro-code-token-keyword)">:</span><span style="color:var(--astro-code-foreground)">East</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-foreground)">   Service</span><span style="color:var(--astro-code-token-keyword)">:</span><span style="color:var(--astro-code-foreground)">East</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-foreground)">   Res.Df RSS Df Sum of Sq F </span><span style="color:var(--astro-code-token-function)">Pr(</span><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-token-punctuation)">F</span><span style="color:var(--astro-code-token-function)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-token-constant)"> 1</span><span style="color:var(--astro-code-token-constant)"> 161</span><span style="color:var(--astro-code-token-constant)"> 5338.9</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-token-constant)"> 2</span><span style="color:var(--astro-code-token-constant)"> 157</span><span style="color:var(--astro-code-token-constant)"> 5186.1</span><span style="color:var(--astro-code-token-constant)"> 4</span><span style="color:var(--astro-code-token-constant)"> 152.82</span><span style="color:var(--astro-code-token-constant)"> 1.1566</span><span style="color:var(--astro-code-token-constant)"> 0.3322</span></span></code></pre>
<p>This means we are happy to adopt the original reduced model.</p>
<h3 id="diagnostics-summary">Diagnostics Summary</h3>
<p>The main tools we will use to validate regression assumptions are,</p>
<ol>
<li>Plots involving <strong>standardized residuals</strong> and/or *<em>fitted values</em>.</li>
<li>Determine <strong>leverage points</strong></li>
<li>Determine which (if any) of the data points are <strong>outliers</strong>.</li>
<li>Asses the effect of each <em>predictor variable</em>, having adjusted for the effect of other predictor variables using <strong>added variable plots</strong>.</li>
<li>Asses the extent of <strong>collinearity</strong> among the predictor variables using <strong>variance inflation factors</strong>.</li>
<li>Examine whether the assumption of <strong>normality of error</strong> and <strong>constant error variance</strong> is reasonable.</li>
</ol>
<h4 id="leverage-points-and-residuals">Leverage Points and Residuals</h4>
<p>Remember from simple linear regression, leverage points are points that have extreme values of the predictor variable.</p>
<p>$$
\mathbf{\hat{Y}} = \mathbf{X} \hat{\beta} = \mathbf{X}(\mathbf{X}^T \mathbf{X})^{-1} \mathbf{X}^T \mathbf{Y} = \mathbf{H} \mathbf{Y},
$$</p>
<p>where $\mathbf{H} = \mathbf{X}(\mathbf{X} \mathbf{X})^{-1} \mathbf{X}^T$ (also called the hat matrix).</p>
<p>Let $h_{ij}$ be the $(i, j)$-entry of $\mathbf{H}$, then,</p>
<p>$$
\hat{Y_i} = h_{ii} Y_i + \sum_{j \neq i} h_{ij} Y_j
$$</p>
<p>The rule of thumb for leverage points are,</p>
<p>$$
h_{ii} > 2 \times \text{average}(h_{ii}) = 2 \times \frac{p+1}{n}
$$</p>
<p>The residuals are defined as,</p>
<p>$$
\mathbf{\hat{e}} = \mathbf{Y} - \mathbf{\hat{Y}} = (\mathbf{I} - \mathbf{H}) \mathbf{Y}
$$</p>
<p>We can show that,</p>
<p>$$
\text{Var}(\mathbf{\hat{e}} | \mathbf{X}) = \sigma^2(\mathbf{I} - \mathbf{H}),
$$</p>
<p>and that the standardized residuals are,</p>
<p>$$
r_i = \frac{\hat{e_i}}{s \sqrt{1 - h_{ii}}}
$$</p>
<p>where,</p>
<p>$$
s = \sqrt{\frac{\sum_{i=1}^n \hat{e_i^2}}{n - p - 1}}
$$</p>
<p>Any pattern in a residual plot indicates that an incorrect model has been fit, but the pattern in general does not provide direct information on how the model is misspecified.</p>
<h4 id="added-variable-plots">Added Variable Plots</h4>
<p>Assume we originally have the model,</p>
<p>$$
\mathbf{Y} \mathbf{X} \beta + \mathbf{e}.
$$</p>
<p>With an <em>additional predictor</em>, we now consider,</p>
<p>$$
\mathbf{Y} = \mathbf{X} \beta + \mathbf{Z} \alpha + \mathbf{e},
$$</p>
<p>where,</p>
<p>$$
\mathbf{Z} =
\begin{bmatrix}
z_1 \newline
z_2 \newline
\vdots \newline
z_n
\end{bmatrix}
$$</p>
<p>The procedure is as follows,</p>
<ol>
<li>Perform Regression
$$
\mathbf{Y} = \mathbf{X} \beta + \mathbf{e}
$$</li>
</ol>
<p>to get the residual $\mathbf{e}_{\mathbf{Y}.\mathbf{X}}$.</p>
<ol start="2">
<li>Perform Regression
$$
\mathbf{Z} = \mathbf{X} \beta + \mathbf{e}
$$</li>
</ol>
<p>to get residual $\mathbf{e}_{\mathbf{Z}.\mathbf{X}}$.</p>
<ol start="3">
<li>Plot $\mathbf{e}_{\mathbf{Y}.\mathbf{X}}$ (on $y$-axis)</li>
</ol>
<p>against $\mathbf{e}_{\mathbf{Z}.\mathbf{X}}$ (on $x$-axis).</p>
<h4 id="transformations">Transformations</h4>
<p>Transforming only $Y$ using inverse response plot.</p>
<p>Assume the true model is actually,</p>
<p>$$
Y = g(\beta_0 + \beta_1 x_1 + \ldots + \beta_p x_p + e),
$$</p>
<p>the inverse model is thus,</p>
<p>$$
g^{-1}(Y) = \beta_0 + \beta_1 x_1 + \ldots + \beta_p x_p + e
$$</p>
<p>To use inverse response plot, an important assumption is that the predictors are pairwise linearly related.</p>
<h5 id="example-defective-rates">Example: Defective rates.</h5>
<p>We want to develop a model for number of defectives based on $x_1$: temperature, $x_2$: density, and $x_3$: production rate.</p>
<p>To get the pairwise linear relationship, we can use the scatterplot matrix.</p>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-background);color:var(--astro-code-foreground); overflow-x: auto;" tabindex="0" data-language="r"><code><span class="line"><span style="color:var(--astro-code-token-function)">pairs</span><span style="color:var(--astro-code-foreground)">(</span><span style="color:var(--astro-code-token-keyword)">~</span><span style="color:var(--astro-code-foreground)">Defective </span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-foreground)"> Temperature </span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-foreground)"> Density </span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-foreground)"> Rate)</span></span></code></pre>
<p>To get the inverse response plot, we can use the following code.</p>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-background);color:var(--astro-code-foreground); overflow-x: auto;" tabindex="0" data-language="r"><code><span class="line"><span style="color:var(--astro-code-foreground)">m1</span><span style="color:var(--astro-code-token-keyword)">&#x3C;-</span><span style="color:var(--astro-code-token-function)">lm</span><span style="color:var(--astro-code-foreground)">(Defective</span><span style="color:var(--astro-code-token-keyword)">~</span><span style="color:var(--astro-code-foreground)">Temperature</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-foreground)">Density</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-foreground)">Rate)</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">inverseResponsePlot(</span><span style="color:var(--astro-code-token-punctuation)">m1</span><span style="color:var(--astro-code-token-function)">)</span></span></code></pre>
<h4 id="collinearity-of-predictors">Collinearity of Predictors</h4>
<p>When higly correlated predictor variables are included, they are effectively carrying very similar information about the response variable.</p>
<p>Thus, it is difficult for least squares to distinguish their separate effects on the response variable.</p>
<p>Some of the coefficients in the regression model are of the opposite sign than expected.</p>
<p>Consider the multiple regression model,</p>
<p>$$
Y = \beta_0 + \beta_1 x_1 + \ldots \beta_p x_p + e.
$$</p>
<p>Let $R_j^2$ be the coefficient of determination $R^2$ obtained when regressing $x_j$ on other predictors.</p>
<p>Then it can be shown that,</p>
<p>$$
\text{Var}(\hat{\beta_j}) = \frac{1}{1 - R_j^2} \frac{\sigma^2}{(n - 1) S_{x_j}^2}
$$</p>
<p>$\frac{1}{1 - R_j^2}$ is called the variance inflation factor.</p>
<p>A rough guide for identifying large VIF is to use the cut-off value 5.</p>
<p>What do you do when collinearity exists?</p>
<ol>
<li>Do nothing but be careful of interpretation.</li>
<li>Remove highly correlated variables (keep only one of them).</li>
</ol> <div class="mt-24"> <div class="grid grid-cols-2 gap-1.5 sm:gap-3"> <a href="/cityu/ma3518/ma3518_4" class="group relative flex flex-nowrap rounded-lg border border-black/15 px-4 py-3 pl-10 no-underline transition-colors duration-300 ease-in-out hover:bg-black/5 hover:text-black focus-visible:bg-black/5 focus-visible:text-black dark:border-white/20 dark:hover:bg-white/5 dark:hover:text-white dark:focus-visible:bg-white/5 dark:focus-visible:text-white"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="absolute left-2 top-1/2 size-5 -translate-y-1/2 fill-none stroke-current stroke-2"> <line x1="5" y1="12" x2="19" y2="12" class="translate-x-3 scale-x-0 transition-transform duration-300 ease-in-out group-hover:translate-x-0 group-hover:scale-x-100 group-focus-visible:translate-x-0 group-focus-visible:scale-x-100"></line> <polyline points="12 5 5 12 12 19" class="translate-x-1 transition-transform duration-300 ease-in-out group-hover:translate-x-0 group-focus-visible:translate-x-0"></polyline> </svg> <div class="flex items-center text-sm"> Part 4 - Simple Linear Regression </div> </a> <div class="invisible"></div> </div> </div> <div class="mt-24"> <div class="giscus"></div> <script data-astro-rerun src="https://giscus.app/client.js" data-repo="rezaarezvan/rezvan.xyz" data-repo-id="R_kgDOHvQr3w" data-category="General" data-category-id="DIC_kwDOHvQr384CiWVC" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="preferred_color_scheme" data-lang="en" data-loading="lazy" crossorigin="anonymous" async></script> </div> </article> </div>  </main> <footer class="animate"> <div class="mx-auto max-w-screen-sm px-3"> <div class="relative"> <div class="absolute -top-12 right-0"> <button id="back-to-top" class="group relative flex w-fit flex-nowrap rounded border border-black/15 py-1.5 pl-8 pr-3 transition-colors duration-300 ease-in-out hover:bg-black/5 hover:text-black focus-visible:bg-black/5 focus-visible:text-black dark:border-white/20 dark:hover:bg-white/5 dark:hover:text-white dark:focus-visible:bg-white/5 dark:focus-visible:text-white"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="absolute left-2 top-1/2 size-4 -translate-y-1/2 rotate-90 fill-none stroke-current stroke-2"> <line x1="5" y1="12" x2="19" y2="12" class="translate-x-2 scale-x-0 transition-transform duration-300 ease-in-out group-hover:translate-x-0 group-hover:scale-x-100 group-focus-visible:translate-x-0 group-focus-visible:scale-x-100"></line> <polyline points="12 5 5 12 12 19" class="translate-x-1 transition-transform duration-300 ease-in-out group-hover:translate-x-0 group-focus-visible:translate-x-0"></polyline> </svg> <div class="text-sm">Back to top</div> </button> </div> </div> <div class="flex items-center justify-between"> <div>&copy; 2025 • rezarezvan.com</div> <div class="flex flex-wrap items-center gap-1.5"></div> </div> </div> </footer> <aside data-pagefind-ignore> <div id="backdrop" class="bg-[rgba(0, 0, 0, 0.5] invisible fixed left-0 top-0 z-50 flex h-screen w-full justify-center p-6 backdrop-blur-sm" data-astro-transition-persist="astro-3snakcvo-2"> <div id="pagefind-container" class="m-0 flex h-fit max-h-[80%] w-full max-w-screen-sm flex-col overflow-auto rounded border border-black/15 bg-neutral-100 p-2 px-4 py-3 shadow-lg dark:border-white/20 dark:bg-neutral-900"> <div id="search" class="pagefind-ui pagefind-init" data-pagefind-ui data-bundle-path="/pagefind/" data-ui-options="{&#34;showImages&#34;:false,&#34;excerptLength&#34;:15,&#34;resetStyles&#34;:false}"></div> <script type="module" src="/_astro/Search.astro_astro_type_script_index_0_lang.C4tRTXsn.js"></script> <div class="mr-2 pb-1 pt-4 text-right text-xs dark:prose-invert">
Press <span class="prose text-xs dark:prose-invert"><kbd class="">Esc</kbd></span> or click anywhere to close
</div> </div> </div> </aside> <script>
  const magnifyingGlass = document.getElementById("magnifying-glass");
  const backdrop = document.getElementById("backdrop");

  function openPagefind() {
    const searchDiv = document.getElementById("search");
    const search = searchDiv.querySelector("input");
    setTimeout(() => {
      search.focus();
    }, 0);
    backdrop?.classList.remove("invisible");
    backdrop?.classList.add("visible");
  }

  function closePagefind() {
    const search = document.getElementById("search");
    search.value = "";
    backdrop?.classList.remove("visible");
    backdrop?.classList.add("invisible");
  }

  // open pagefind
  magnifyingGlass?.addEventListener("click", () => {
    openPagefind();
  });

  document.addEventListener("keydown", (e) => {
    if (e.key === "/") {
      e.preventDefault();
      openPagefind();
    } else if ((e.metaKey || e.ctrlKey) && e.key === "k") {
      e.preventDefault();
      openPagefind();
    }
  });

  // close pagefind
  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape" || e.keyCode === 27) {
      closePagefind();
    }
  });

  // close pagefind when searched result(link) clicked
  document.addEventListener("click", (event) => {
    if (event.target.classList.contains("pagefind-ui__result-link")) {
      closePagefind();
    }
  });

  backdrop?.addEventListener("click", (event) => {
    if (!event.target.closest("#pagefind-container")) {
      closePagefind();
    }
  });

  // prevent form submission
  const form = document.getElementById("form");
  form?.addEventListener("submit", (event) => {
    event.preventDefault();
  });
</script>  </body></html>