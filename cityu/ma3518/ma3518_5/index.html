<!DOCTYPE html><html lang="en-US"> <head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"><meta name="generator" content="Astro v5.7.1"><meta name="robots" content="index, follow"><meta name="HandheldFriendly" content="True"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="format-detection" content="telephone=no,date=no,address=no,email=no,url=no"><meta name="theme-color" content="#121212" media="(prefers-color-scheme: dark)"><meta name="theme-color" content="#121212" media="(prefers-color-scheme: light)"><link rel="sitemap" href="/sitemap-index.xml"><link rel="manifest" href="/site.webmanifest"><link rel="alternate" type="application/rss+xml" title="rezarezvan.com" href="https://rezaarezvan.com/rss.xml"><!-- PageFind --><link href="/pagefind/pagefind-ui.css" rel="stylesheet"><script src="/pagefind/pagefind-ui.js"></script><!-- KaTeX support --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.15/dist/katex.min.css" integrity="sha384-Htz9HMhiwV8GuQ28Xr9pEs1B4qJiYu/nYLLwlDklR53QibDfmQzi7rYxXhMH/5/u" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.15/dist/katex.min.js" integrity="sha384-bxmi2jLGCvnsEqMuYLKE/KsVCxV3PqmKeK6Y6+lmNXBry6+luFkEOsmp5vD9I/7+" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.15/dist/contrib/auto-render.min.js" integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><!-- inline KaTeX --><script>
    function renderKaTeX() {
      if (typeof renderMathInElement !== 'undefined') {
        renderMathInElement(document.body, {
          delimiters: [
            { left: '$$', right: '$$', display: true },
            { left: '$', right: '$', display: false },
          ],
        })
      }
    }

    document.addEventListener('DOMContentLoaded', renderKaTeX)
    document.addEventListener('astro:after-swap', renderKaTeX)
  </script><link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96"><link rel="icon" type="image/svg+xml" href="/favicon.ico"><link rel="shortcut icon" href="/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><meta name="apple-mobile-web-app-title" content="rezvan-blog"><link rel="manifest" href="/site.webmanifest"><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><script type="module" src="/_astro/ClientRouter.astro_astro_type_script_index_0_lang.BZs-2RF_.js"></script><script>
    function init() {
      setGiscusTheme()
    }

    const setGiscusTheme = () => {
      const giscus = document.querySelector('.giscus-frame')

      const isDark = document.documentElement.classList.contains('dark')

      if (giscus) {
        const url = new URL(giscus.src)
        url.searchParams.set('theme', isDark ? 'dark' : 'light')
        giscus.src = url.toString()
      }
    }

    document.addEventListener('DOMContentLoaded', () => init())
    document.addEventListener('astro:after-swap', () => init())
  </script><title>Part 5 - Multiple Linear Regression | rezarezvan.com</title><meta name="title" content="Part 5 - Multiple Linear Regression | rezarezvan.com"><meta name="description" content="Personal website and course notes repository"><link rel="canonical" href="https://rezarezvan.com"><meta property="og:title" content="Part 5 - Multiple Linear Regression"><meta property="og:description" content="Personal website and course notes repository"><meta property="og:image" content="https://rezarezvan.comundefined"><meta property="og:image:alt" content="Part 5 - Multiple Linear Regression"><meta property="og:type" content="website"><meta property="og:locale" content="en-US"><meta property="og:site_name" content="rezarezvan.com"><meta property="og:url" content="https://rezaarezvan.com/cityu/ma3518/ma3518_5/"><meta name="twitter:title" content="Part 5 - Multiple Linear Regression"><meta name="twitter:description" content="Personal website and course notes repository"><meta property="twitter:image" content="https://rezarezvan.comundefined"><meta name="twitter:image:alt" content="Part 5 - Multiple Linear Regression"><meta name="twitter:card" content="summary_large_image"><link rel="stylesheet" href="/_astro/index.CMAis0x6.css"></head><body> <div class="flex h-fit min-h-screen flex-col gap-y-6 font-sans"> <header class="bg-background/50 sticky top-0 z-10 backdrop-blur-md" data-astro-transition-persist="astro-l7r54iwe-1"> <div class="mx-auto flex max-w-3xl flex-wrap items-center justify-between gap-4 p-4"> <a href="/" target="_self" class="transition-colors duration-300 ease-in-out flex shrink-0 items-center gap-2 text-xl font-medium"> rezarezvan.com </a> <div class="flex items-center gap-2 md:gap-4"> <nav class="hidden items-center gap-4 text-sm sm:gap-6 md:flex"> <a href="/blog" target="_self" class="inline-block duration-300 ease-in-out hover:text-foreground/30 transition-colors"> blog<span>/</span>  </a><a href="/chalmers" target="_self" class="inline-block duration-300 ease-in-out hover:text-foreground/30 transition-colors"> chalmers<span>/</span>  </a><a href="/cityu" target="_self" class="inline-block duration-300 ease-in-out hover:text-foreground/30 transition-colors"> cityu<span>/</span>  </a><a href="/about" target="_self" class="inline-block duration-300 ease-in-out hover:text-foreground/30 transition-colors"> about<span>/</span>  </a> </nav> <button id="magnifying-glass" aria-label="Search" class="flex items-center rounded border border-black/15 bg-neutral-100 px-2 py-1 text-xs transition-colors duration-300 ease-in-out hover:bg-black/5 hover:text-black focus-visible:bg-black/5 focus-visible:text-black dark:border-white/20 dark:bg-neutral-900 dark:hover:bg-white/5 dark:hover:text-white dark:focus-visible:bg-white/5 dark:focus-visible:text-white"> <svg height="16" stroke-linejoin="round" viewBox="0 0 16 16" width="16" style="color: currentcolor;"> <path fill-rule="evenodd" clip-rule="evenodd" d="M3.5 7C3.5 5.067 5.067 3.5 7 3.5C8.933 3.5 10.5 5.067 10.5 7C10.5 7.88461 10.1718 8.69256 9.63058 9.30876L9.30876 9.63058C8.69256 10.1718 7.88461 10.5 7 10.5C5.067 10.5 3.5 8.933 3.5 7ZM9.96544 11.0261C9.13578 11.6382 8.11014 12 7 12C4.23858 12 2 9.76142 2 7C2 4.23858 4.23858 2 7 2C9.76142 2 12 4.23858 12 7C12 8.11014 11.6382 9.13578 11.0261 9.96544L14.0303 12.9697L14.5607 13.5L13.5 14.5607L12.9697 14.0303L9.96544 11.0261Z" fill="currentColor"></path> </svg>
&nbsp;Search
</button> <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();;(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t),11:t=>1/0*t},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="Z2dJ8uD" prefix="r4" component-url="/_astro/mobile-menu.C9T2c5u4.js" component-export="default" renderer-url="/_astro/client.DXT7MGXl.js" props="{&quot;data-astro-transition-persist&quot;:[0,&quot;astro-lci6dfah-2&quot;]}" ssr client="load" opts="{&quot;name&quot;:&quot;MobileMenu&quot;,&quot;value&quot;:true}" data-astro-transition-persist="astro-lci6dfah-2" await-children><button data-slot="dropdown-menu-trigger" class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 size-9 md:hidden" title="Menu" type="button" id="radix-:r4R0:" aria-haspopup="menu" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu h-5 w-5"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg><span class="sr-only">Toggle menu</span></button><!--astro:end--></astro-island> <button data-slot="button" class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 size-9" id="theme-toggle" title="Toggle theme"> <svg width="1em" height="1em" class="size-4 scale-100 rotate-0 transition-all dark:scale-0 dark:-rotate-90" data-icon="lucide:sun">   <symbol id="ai:lucide:sun" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><circle cx="12" cy="12" r="4"/><path d="M12 2v2m0 16v2M4.93 4.93l1.41 1.41m11.32 11.32l1.41 1.41M2 12h2m16 0h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41"/></g></symbol><use href="#ai:lucide:sun"></use>  </svg> <svg width="1em" height="1em" class="absolute size-4 scale-0 rotate-90 transition-all dark:scale-100 dark:rotate-0" data-icon="lucide:moon">   <symbol id="ai:lucide:moon" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3a6 6 0 0 0 9 9a9 9 0 1 1-9-9"/></symbol><use href="#ai:lucide:moon"></use>  </svg> <span class="sr-only">Toggle theme</span> </button> <script data-astro-rerun>
  const theme = (() => {
    const localStorageTheme = localStorage?.getItem('theme') ?? ''
    if (['dark', 'light'].includes(localStorageTheme)) {
      return localStorageTheme
    }
    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
      return 'dark'
    }
    return 'light'
  })()

  if (theme === 'light') {
    document.documentElement.classList.remove('dark')
  } else {
    document.documentElement.classList.add('dark')
  }

  window.localStorage.setItem('theme', theme)
</script> <script type="module">function a(){const e=document.documentElement;e.classList.add("disable-transitions"),e.classList.toggle("dark"),window.getComputedStyle(e).getPropertyValue("opacity"),requestAnimationFrame(()=>{e.classList.remove("disable-transitions")});const t=e.classList.contains("dark");localStorage.setItem("theme",t?"dark":"light")}function s(){const e=document.getElementById("theme-toggle");e&&e.addEventListener("click",a)}s();document.addEventListener("astro:after-swap",()=>{const e=localStorage.getItem("theme"),t=document.documentElement;t.classList.add("disable-transitions"),window.getComputedStyle(t).getPropertyValue("opacity"),e==="dark"?t.classList.add("dark"):t.classList.remove("dark"),requestAnimationFrame(()=>{t.classList.remove("disable-transitions")}),s()});</script> </div> </div> </header> <main class="grow"> <div class="mx-auto flex grow flex-col gap-y-6 px-4">   <section class="grid grid-cols-[minmax(0px,1fr)_min(calc(var(--breakpoint-md)-2rem),100%)_minmax(0px,1fr)] gap-y-6"> <div class="col-start-2"> <nav aria-label="breadcrumb" data-slot="breadcrumb"> <ol data-slot="breadcrumb-list" class="text-muted-foreground flex flex-wrap items-center gap-1.5 text-sm break-words sm:gap-2.5"> <li data-slot="breadcrumb-item" class="inline-flex items-center gap-1.5"> <a data-slot="breadcrumb-link" class="hover:text-foreground transition-colors" href="/"> <svg width="1em" height="1em" class="size-4" data-icon="lucide:home">   <symbol id="ai:lucide:home" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8"/><path d="M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/></g></symbol><use href="#ai:lucide:home"></use>  </svg> </a> </li>  <li data-slot="breadcrumb-separator" role="presentation" aria-hidden="true" class="[&amp;&gt;svg]:size-3.5"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.1584 3.13508C6.35985 2.94621 6.67627 2.95642 6.86514 3.15788L10.6151 7.15788C10.7954 7.3502 10.7954 7.64949 10.6151 7.84182L6.86514 11.8418C6.67627 12.0433 6.35985 12.0535 6.1584 11.8646C5.95694 11.6757 5.94673 11.3593 6.1356 11.1579L9.565 7.49985L6.1356 3.84182C5.94673 3.64036 5.95694 3.32394 6.1584 3.13508Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></li> <li data-slot="breadcrumb-item" class="inline-flex items-center gap-1.5"><a data-slot="breadcrumb-link" class="hover:text-foreground transition-colors" href="/cityu"> <span class="flex items-center gap-x-2"> <svg width="1em" height="1em" class="size-4" data-icon="lucide:graduation-cap">   <symbol id="ai:lucide:graduation-cap" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0zM22 10v6"/><path d="M6 12.5V16a6 3 0 0 0 12 0v-3.5"/></g></symbol><use href="#ai:lucide:graduation-cap"></use>  </svg> CityU </span> </a></li>  <li data-slot="breadcrumb-separator" role="presentation" aria-hidden="true" class="[&amp;&gt;svg]:size-3.5"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.1584 3.13508C6.35985 2.94621 6.67627 2.95642 6.86514 3.15788L10.6151 7.15788C10.7954 7.3502 10.7954 7.64949 10.6151 7.84182L6.86514 11.8418C6.67627 12.0433 6.35985 12.0535 6.1584 11.8646C5.95694 11.6757 5.94673 11.3593 6.1356 11.1579L9.565 7.49985L6.1356 3.84182C5.94673 3.64036 5.95694 3.32394 6.1584 3.13508Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></li> <li data-slot="breadcrumb-item" class="inline-flex items-center gap-1.5"><a data-slot="breadcrumb-link" class="hover:text-foreground transition-colors" href="/cityu/ma3518"> <span class="flex items-center gap-x-2"> <svg width="1em" height="1em" class="size-4" data-icon="lucide:book-open">   <symbol id="ai:lucide:book-open" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 7v14m-9-3a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4a4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3a3 3 0 0 0-3-3z"/></symbol><use href="#ai:lucide:book-open"></use>  </svg> Applied Statistics </span> </a></li>  <li data-slot="breadcrumb-separator" role="presentation" aria-hidden="true" class="[&amp;&gt;svg]:size-3.5"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.1584 3.13508C6.35985 2.94621 6.67627 2.95642 6.86514 3.15788L10.6151 7.15788C10.7954 7.3502 10.7954 7.64949 10.6151 7.84182L6.86514 11.8418C6.67627 12.0433 6.35985 12.0535 6.1584 11.8646C5.95694 11.6757 5.94673 11.3593 6.1356 11.1579L9.565 7.49985L6.1356 3.84182C5.94673 3.64036 5.95694 3.32394 6.1584 3.13508Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></li> <li data-slot="breadcrumb-item" class="inline-flex items-center gap-1.5"><span data-slot="breadcrumb-page" role="link" aria-disabled="true" aria-current="page" class="text-foreground font-normal"> <span class="flex items-center gap-x-2"> <svg width="1em" height="1em" class="size-4" data-icon="lucide:file-text">   <symbol id="ai:lucide:file-text" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/><path d="M14 2v4a2 2 0 0 0 2 2h4M10 9H8m8 4H8m8 4H8"/></g></symbol><use href="#ai:lucide:file-text"></use>  </svg> Part 5 - Multiple Linear Regression </span> </span></li> </ol> </nav> </div>  <section class="col-start-2 flex flex-col gap-y-6 text-center"> <div class="flex flex-col"> <h1 class="mb-2 text-4xl leading-tight font-medium text-pretty sm:text-5xl"> Part 5 - Multiple Linear Regression </h1> <div class="text-muted-foreground mb-4 flex flex-wrap items-center justify-center gap-2 text-sm"> <div class="flex items-center gap-2"> <span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden text-foreground [a&amp;]:hover:bg-accent [a&amp;]:hover:text-accent-foreground">MA3518</span> <div data-orientation="vertical" role="none" data-slot="separator-root" class="bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px h-4!"></div> <span>November 21, 2024</span> <div data-orientation="vertical" role="none" data-slot="separator-root" class="bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px h-4!"></div>  <div class="font-base text-sm">
Last modified: April 15, 2025 </div>  <div data-orientation="vertical" role="none" data-slot="separator-root" class="bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px h-4!"></div> <span>13 min read</span> </div> </div> </div> <nav class="col-start-2 grid grid-cols-1 gap-4 sm:grid-cols-2"> <a href="#" target="_self" class="duration-300 ease-in-out gap-2 whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&#38;_svg]:pointer-events-none [&#38;_svg:not([class*='size-'])]:size-4 shrink-0 [&#38;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 px-4 py-2 has-[>svg]:px-3 rounded-xl group flex items-center justify-start size-full pointer-events-none opacity-50 cursor-not-allowed" aria-disabled="true">  <svg width="1em" height="1em" class="mr-2 size-4 transition-transform group-hover:-translate-x-1" data-icon="lucide:arrow-left">   <symbol id="ai:lucide:arrow-left" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m12 19l-7-7l7-7m7 7H5"/></symbol><use href="#ai:lucide:arrow-left"></use>  </svg> <div class="flex flex-col items-start overflow-hidden text-wrap"> <span class="text-muted-foreground text-left text-xs">Next Post</span> <span class="w-full text-left text-sm text-ellipsis"> Latest post! </span> </div>  </a> <a href="/cityu/ma3518/ma3518_4" target="_self" class="duration-300 ease-in-out gap-2 whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&#38;_svg]:pointer-events-none [&#38;_svg:not([class*='size-'])]:size-4 shrink-0 [&#38;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 px-4 py-2 has-[>svg]:px-3 rounded-xl group flex items-center justify-end size-full" aria-disabled="false">  <div class="flex flex-col items-end overflow-hidden text-wrap"> <span class="text-muted-foreground text-right text-xs">Previous Post</span> <span class="w-full text-right text-sm text-ellipsis"> Part 4 - Simple Linear Regression </span> </div> <svg width="1em" height="1em" class="ml-2 size-4 transition-transform group-hover:translate-x-1" data-icon="lucide:arrow-right">   <symbol id="ai:lucide:arrow-right" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14m-7-7l7 7l-7 7"/></symbol><use href="#ai:lucide:arrow-right"></use>  </svg>  </a> </nav> </section> <details open class="group col-start-2 rounded-xl border p-4 xl:sticky xl:top-20 xl:col-start-1 xl:mr-8 xl:ml-auto xl:h-[calc(100vh-5rem)] xl:max-w-fit xl:rounded-none xl:border-none xl:p-0"> <summary class="flex cursor-pointer items-center justify-between text-xl font-medium group-open:pb-4 xl:hidden"> <span>Table of Contents</span> <svg width="1em" height="1em" class="size-5 shrink-0 transition-transform group-open:rotate-180" data-icon="lucide:chevron-down">   <symbol id="ai:lucide:chevron-down" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m6 9l6 6l6-6"/></symbol><use href="#ai:lucide:chevron-down"></use>  </svg> </summary> <astro-island uid="LfMf4" prefix="r9" component-url="/_astro/scroll-area.DmWfVO5M.js" component-export="ScrollArea" renderer-url="/_astro/client.DXT7MGXl.js" props="{&quot;className&quot;:[0,&quot;flex max-h-64 flex-col overflow-y-auto xl:max-h-[calc(100vh-8rem)]&quot;],&quot;type&quot;:[0,&quot;always&quot;]}" ssr client="load" opts="{&quot;name&quot;:&quot;ScrollArea&quot;,&quot;value&quot;:true}" await-children><div dir="ltr" data-slot="scroll-area" class="relative flex max-h-64 flex-col overflow-y-auto xl:max-h-[calc(100vh-8rem)]" style="position:relative;--radix-scroll-area-corner-width:0px;--radix-scroll-area-corner-height:0px"><style>[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}</style><div data-radix-scroll-area-viewport="" data-slot="scroll-area-viewport" class="ring-ring/10 dark:ring-ring/20 dark:outline-ring/40 outline-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] focus-visible:ring-4 focus-visible:outline-1" style="overflow-x:hidden;overflow-y:hidden"><div style="min-width:100%;display:table"><astro-slot> <ul class="flex list-none flex-col gap-y-2 px-4 xl:mr-8" id="table-of-contents"> <li class="hidden text-lg font-medium xl:block">Table of Contents</li> <li class="text-foreground/60 px-4 text-sm xl:p-0 ml-4"> <a href="#introduction" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Introduction </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-8"> <a href="#matrix-form" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Matrix Form </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-4"> <a href="#inference" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Inference </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-8"> <a href="#example" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Example </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-4"> <a href="#interaction-effects" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Interaction Effects </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-4"> <a href="#diagnostics-summary" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Diagnostics Summary </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-8"> <a href="#leverage-points-and-residuals" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Leverage Points and Residuals </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-8"> <a href="#added-variable-plots" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Added Variable Plots </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-8"> <a href="#transformations" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Transformations </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-12"> <a href="#example-defective-rates" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Example: Defective rates. </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-8"> <a href="#collinearity-of-predictors" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Collinearity of Predictors </a> </li> </ul> </astro-slot></div></div><div data-orientation="vertical" data-slot="scroll-area-scrollbar" class="flex touch-none p-px transition-colors select-none h-full w-2.5 border-l border-l-transparent" style="position:absolute;top:0;right:0;bottom:var(--radix-scroll-area-corner-height);--radix-scroll-area-thumb-height:18px"></div></div><!--astro:end--></astro-island> </details> <script type="module">function s(){const t=document.querySelector("header"),c=t?t.offsetHeight:0,a=new IntersectionObserver(e=>{e.forEach(o=>{const r=o.target.querySelector("h2, h3, h4, h5, h6");if(!r)return;const d=r.getAttribute("id"),n=document.querySelector(`#table-of-contents li a[href="#${d}"]`);if(!n)return;const i=o.isIntersecting?"add":"remove";n.classList[i]("text-foreground")})},{rootMargin:`-${c}px 0px 0px 0px`});document.querySelectorAll(".prose section").forEach(e=>{a.observe(e)})}document.addEventListener("astro:page-load",s);document.addEventListener("astro:after-swap",s);</script> <article class="prose col-start-2 max-w-none"> <!doctype html><html lang="en"><head></head><body>


<meta charset="utf-8">
<title>MA3518_5</title>
<meta content="width=device-width, initial-scale=1" name="viewport">
<link href="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css" rel="stylesheet">


<section><h3 id="introduction">Introduction</h3><p>Last time we discussed simple linear regression, which is a model that predicts the value of a dependent variable based on the value of a single independent variable.
But, often in the real world, we may want to model our dependant variable from multiple independent variables.</p><p>Or, mathematically represented as,</p><p>$$
Y_i = \beta_0 + \beta_1 x_{1i} 0 \beta_2 x_{2i} + \ldots + \beta_p x_{pi} + e_i
$$</p><p>To have a “good” fit, we try to minimize RSS, however, since we now have multiple variables, we need to minimize the RSS with respect to all the variables.</p><p>$$
\begin{align*}
RSS &#x26;= \sum_{i=1}^{n} (y_i - b_0 - b_1 - \ldots - b_p x_{pi})^2 \newline
&#x26;= \frac{\partial RSS}{\partial b_0} = -2 \sum_{i=1}^{n} (y_i - b_0 - b_1 x_{1i} - b_2 x_{2i} - \ldots - b_p x_{pi}) = 0 \newline
&#x26;= \frac{\partial RSS}{\partial b_1} = -2 \sum_{i=1}^{n} x_{1i} (y_i - b_0 - b_1 x_{1i} - b_2 x_{2i} - \ldots - b_p x_{pi}) = 0 \newline
&#x26; \vdots \newline
&#x26;= \frac{\partial RSS}{\partial b_p} = -2 \sum_{i=1}^{n} x_{pi} (y_i - b_0 - b_1 x_{1i} - b_2 x_{2i} - \ldots - b_p x_{pi}) = 0 \newline
\end{align*}
$$</p><section><h4 id="matrix-form">Matrix Form</h4><p>Using matrix formulation is more convenient,</p><p>$$
\mathbf{Y} =
\begin{bmatrix}
y_1 \newline
y_2 \newline
\vdots \newline
y_n
\end{bmatrix},
\mathbf{X} =
\begin{bmatrix}
1 &#x26; x_{11} &#x26; \ldots &#x26; x_{1p} \newline
1 &#x26; x_{21} &#x26; \ldots &#x26; x_{2p} \newline
\vdots &#x26; \vdots &#x26; \ddots &#x26; \vdots \newline
1 &#x26; x_{n1} &#x26; \ldots &#x26; x_{np}
\end{bmatrix},
\beta =
\begin{bmatrix}
\beta_0 \newline
\beta_1 \newline
\vdots \newline
\beta_p
\end{bmatrix},
\mathbf{e} =
\begin{bmatrix}
e_1 \newline
e_2 \newline
\vdots \newline
e_n
\end{bmatrix}
$$</p><p>Thus, the matrix form of the equation is,</p><p>$$
\mathbf{Y} = \mathbf{X} \beta + \mathbf{e}
$$</p><p>Now, we can write the RSS, denoted as $RSS(\beta)$, in matrix form as,</p><p>$$
RSS(\beta) = (\mathbf{Y} - \mathbf{X} \beta)^T (\mathbf{Y} - \mathbf{X} \beta)
$$</p><p>We can also write our predictor for $\hat{\beta}$ as,</p><p>$$
\hat{\beta} = (\mathbf{X}^T \mathbf{X})^{-1} \mathbf{X}^T \mathbf{Y}
$$</p><p>Since we are trying to generalize linear regression with this, it must mean that simple linear regression is a special case of multiple linear.</p><p>$$
\mathbf{X}^T \mathbf{X} =
\begin{bmatrix}
1 &#x26; 1 &#x26; \ldots &#x26; 1 \newline
x_1 &#x26; x_2 &#x26; \ldots &#x26; x_n
\end{bmatrix}
\begin{bmatrix}
1 &#x26; x_1 \newline
1 &#x26; x_2 \newline
\vdots &#x26; \vdots \newline
1 &#x26; x_n
\end{bmatrix} =
\begin{bmatrix}
n &#x26; \sum_{i=1}^{n} x_i \newline
\sum_{i=1}^{n} x_i &#x26; \sum_{i=1}^{n} x_i^2
\end{bmatrix} = n
\begin{bmatrix}
1 &#x26; \bar{x} \newline
\bar{x} &#x26; \frac{1}{n} \sum_{i=1}^{n} x_i^2
\end{bmatrix}
$$</p><p>The inverse of this matrix is,
$$
(\mathbf{X}^T \mathbf{X})^{-1} = \frac{1}{n \left( \frac{1}{n} \sum_{i=1}^{n} x_i^2 - \bar{x}^2 \right)}
\begin{bmatrix}
\frac{1}{n} \sum_{i=1}^{n} x_i^2 &#x26; -\bar{x} \newline
-\bar{x} &#x26; 1
\end{bmatrix} =
\frac{1}{S_{xx}}
\begin{bmatrix}
\frac{1}{n} \sum_{i=1}^{n} x_i^2 &#x26; -\bar{x} \newline
-\bar{x} &#x26; 1
\end{bmatrix}
$$</p><p>$$
\mathbf{X}^T \mathbf{Y} =
\begin{bmatrix}
1 &#x26; 1 &#x26; \ldots &#x26; 1 \newline
x_1 &#x26; x_2 &#x26; \ldots &#x26; x_n
\end{bmatrix}
\begin{bmatrix}
y_1 \newline
y_2 \newline
\vdots \newline
y_n
\end{bmatrix} =
\begin{bmatrix}
\sum_{i=1}^{n} y_i \newline
\sum_{i=1}^{n} x_i y_i
\end{bmatrix}
$$</p><p>Which finally means that $\hat{\beta}$ is,</p><p>$$
\begin{align*}
\hat{\beta} &#x26;= \frac{1}{S_{xx}}
\begin{bmatrix}
\frac{1}{n} \sum_{i=1}^{n} x_i^2 &#x26; -\bar{x} \newline
-\bar{x} &#x26; 1
\end{bmatrix}
\begin{bmatrix}
\sum_{i=1}^{n} y_i \newline
\sum_{i=1}^{n} x_i y_i
\end{bmatrix} \newline
&#x26;= \frac{1}{S_{xx}}
\begin{bmatrix}
\frac{1}{n} \sum_{i=1}^{n} y_i \sum_{i=1}^{n} x_i^2 - \bar{x} \sum_{i=1}^{n} x_i y_i \newline
\sum_{i=1}^{n} x_i y_i - \bar{x} \sum_{i=1}^{n} y_i
\end{bmatrix} \newline
&#x26;=
\begin{bmatrix}
\frac{\bar{y} \left[ \sum_{i=1}^n x_i^2 - n\bar{x}^2 \right] - \bar{x} \left[ \sum_{i=1}^n x_i y_i - n\bar{x}\bar{y} \right]}{S_{xx}} \newline
\frac{S_{xy}}{S_{xx}}
\end{bmatrix} \newline
&#x26;=
\begin{bmatrix}
\bar{y} - \frac{S_{xy}}{S_{xx}} \bar{x} \newline
\frac{S_{xy}}{S_{xx}}
\end{bmatrix}
\end{align*}
$$</p><p>So we finally have our $\beta_0$ and $\beta_1$.</p><p>Let’s take a look at some properties of the multiple linear regression model.</p><p>$$
\begin{align*}
\mathbb{E}(\hat{\beta} | \mathbf{X}) &#x26;= \beta \newline
\text{Var}(\hat{\beta} | \mathbf{X}) &#x26;= \sigma^2 (\mathbf{X}^T \mathbf{X})^{-1}
S^2 &#x26;= \frac{RSS}{n-p-1} = \frac{\sum_{i=1}^{n} \hat{e}_i^2}{n-p-1}
\end{align*}
$$</p></section></section>
<section><h3 id="inference">Inference</h3><p>We can define inference for a <em>single</em> parameter as such,</p><p>$$
T_i = \frac{\hat{\beta_i} - \beta_i}{SE(\hat{\beta_i})} \sim t_{n-p-1}
$$</p><p>Analysis of variance approach to inference is also possible,</p><p>$$
H_0 : \beta_1 = \ldots = \beta_p = 0 \newline
H_1 : \text{At least one } \beta_j \neq 0
$$</p><p>Let’s recall some important definitions,</p><p>$$
\begin{align*}
SST = S_{yy} &#x26;= \sum_{i=1}^{n} (y_i - \bar{y})^2 \newline
RSS = &#x26;= \sum_{i=1}^{n} (y_i - \hat{y_i})^2 \newline
SS_{\text{reg}} &#x26;= \sum_{i=1}^{n} (\hat{y_i} - \bar{y})^2
SST = SS_{\text{reg}} + RSS
\end{align*}
$$</p><p>The test statistic is defined as,</p><p>$$
F = \frac{SS_{reg}/p}{RSS/(n-p-1)} \sim F_{p, n-p-1}
$$</p><p>where we reject $H_0$ if $F$ is too large.</p><p>Recall our analysis of variance table,</p>
































<table><thead><tr><th>Source of Variation</th><th>Degrees of Freedom (df)</th><th>Sum of Squares (SS)</th><th>Mean Square (MS)</th><th>F-statistic</th></tr></thead><tbody><tr><td>Regression</td><td>p</td><td>$SS_{\text{reg}}$</td><td>$SS_{\text{reg}}/p$</td><td>$F = \frac{SS_{\text{reg}}/p}{RSS/(n - p - 1)}$</td></tr><tr><td>Residual</td><td>$n - p - 1$</td><td>$RSS$</td><td>$S^2 = \frac{RSS}{n - p - 1}$</td><td></td></tr><tr><td>Total</td><td>$n - 1$</td><td>$SST = S_{yy}$</td><td></td><td></td></tr></tbody></table><p>The coefficient of determination and adjusted coefficient of determination are defined as,</p><p>$$
\begin{align*}
R^2 &#x26;= \frac{SS_{\text{reg}}}{SST} = 1 - \frac{RSS}{SST} \newline
R^2_{\text{adj}} &#x26;= 1 - \frac{RSS/(n-p-1)}{SST/(n-1)}
\end{align*}
$$</p><p>This new adjusted coefficient of determination is due to the fact of, if we add variables (even irrelevant variables) $R^2$ never decreases.
Thus to compare the model with different number of variables, we use this.</p><p>We can also test a <em>subset</em> of coefficients using ANOVA.</p><p>$$
H_0 : \beta_1 = \ldots = \beta_k = 0 \newline
H_1 : \text{At least one } \beta_j \neq 0
$$</p><p>Then the test statistic is,</p><p>$$
\begin{align*}
F &#x26;= \frac{(RSS(\text{reduced} - RSS(\text{full}))/(df_{\text{reduced}} - df_{\text{full}})}{RSS(\text{full})/df_{\text{full}}} \newline
&#x26;= \frac{(RSS(\text{reduced} - RSS(\text{full}))/k}{RSS(\text{full})/(n-p-1)}
\end{align*}
$$</p><p>since $df_{\text{reduced}} - df_{\text{full}} = (n - (p + 1 - k) - (n - (p + 1)) = k$.</p><section><h4 id="example">Example</h4><p>Let’s look at a simple example and the corresponding R code.</p><blockquote>
<p>Data from surveys of customers of 168 Italian restaurants in the target area are available, with the following variables:
$$
\begin{align*}
Y &#x26;= \text{Price} = \text{the price (in \$US) of a dinner (including 1 drink \&#x26; a tip)} \newline
x_1 &#x26;= \text{Food} = \text{customer rating of the food (out of 30)} \newline
x_2 &#x26;= \text{Décor} = \text{customer rating of the decor (out of 30)} \newline
x_3 &#x26;= \text{Service} = \text{customer rating of the service (out of 30)} \newline
x_4 &#x26;= \text{East} = \text{dummy variable} = 1 \text{ if the restaurant is east of Fifth Avenue, 0 if it is west}
\end{align*}
$$</p>
</blockquote><p>So, let’s first devlop a regression model that <em>predicts</em> the price of a dinner.</p><figure data-rehype-pretty-code-figure=""><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0" data-language="r" data-theme="github-light github-dark"><code data-language="r" data-theme="github-light github-dark" style="display: grid;"><span data-line=""><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Assume data is loaded into `nyc`.</span></span>
<span data-line=""><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">attach</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(nyc)</span></span>
<span data-line=""><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">m1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">lm</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(Price</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Food</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Decor</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Service</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">East)</span></span>
<span data-line=""><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">summary</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(m1)</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Coefficients</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">             Estimate Std. Error t value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">Pr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">>|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (Intercept)  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">24.244248</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   4.758009</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">5.095</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 9.70e-07</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ***</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Food          </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1.553922</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   0.372672</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   4.170</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 4.98e-05</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ***</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Decor         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1.897926</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   0.219100</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   8.662</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 4.79e-15</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ***</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Service       </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0.005318</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   0.399493</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   0.013</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0.9894</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> East          </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2.003432</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   0.961794</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   2.083</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0.0388</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ---</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Signif. codes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ‘</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">***</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">’ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0.001</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ‘</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">’ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0.01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ‘</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">’ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0.05</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ‘.’ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ‘ ’ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span></span></code></pre></figure><p>So, our initial regression model is,</p><p>$$
\text{Price} = -24.244248 + 1.553922 \text{Food} + 1.897926 \text{Decor} + 0.005318 \text{Service} + 2.003432 \text{East}
$$</p><p>We can see that Décor has the largest effect on the price (note that Food, Décor and Service are each measured on the same 0 to 30 scale so it is meaningful to compare the regression coefficients).</p><p>We can also observe that, if a new resturant wants to choose a location, it should be east of Fifth Avenue, since our dummy variable is statistically significantly larger than 0.</p></section></section>
<section><h3 id="interaction-effects">Interaction Effects</h3><p>Consider we want to model $Y$ based on a continuous predictor $x$ and a dummy variable $d$.
Compared to using a single variable $x$, the additional effect of $d$ could be,</p><ol>
<li>$d$ ahs no effect on $Y$, that is, $Y = \beta_0 + \beta_1 x + e$.</li>
<li>$d$ produces only an additive change in $Y$, that is,
$$
Y = \beta_0 + \beta_1 x + \beta_2 d + e =
\begin{cases}
\beta_0 + \beta_1 x + e &#x26; d = 0 \newline
\beta_0 + \beta_2 + \beta_1 x + e &#x26; d = 1
\end{cases}
$$</li>
<li>$d$ produces an additive change in $Y$ and also changes the size of the effect of $x$ on $Y$, that is,
$$
Y = \beta_0 + \beta_1 x + \beta_2 d + \beta_3 xd + e =
\begin{cases}
\beta_0 + \beta_1 x + e &#x26; d = 0 \newline
\beta_0 + \beta_2 + (\beta_1  + \beta_3) x + e &#x26; d = 1
\end{cases}
$$</li>
</ol><p>Let’s go back to our example again.</p><blockquote>
<p>After you present your model to the management team, the debate foucses on the statistical insignificane of the Service variable.
The team feels like the model may be too simple to reflect the reality of a Italian restaurant in Manhattan.
In particular, there is general consensus amongst the team that restaurants on the east of Fifth Avenue are very different from those on the west side.
As such, you have been asked to consider different models for the East and West.</p>
</blockquote><p>So, we can develop a mathematical model as such,</p><p>$$
Y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_3 + \beta_4 \text{East} + \beta_5 x_1 \text{East} + \beta_6 x_2 \text{East} + \beta_7 x_3 \text{East} + e
$$</p><p>In our code now,</p><figure data-rehype-pretty-code-figure=""><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0" data-language="r" data-theme="github-light github-dark"><code data-language="r" data-theme="github-light github-dark" style="display: grid;"><span data-line=""><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">m2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">lm</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(Price</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Food</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Decor</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Service</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">East</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Food</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">East</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Decor</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">East</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Serivce</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">East)</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Coefficients</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">             Estimate Std. Error t value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">Pr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">>|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (Intercept) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">26.9305</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   8.5195</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3.161</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0.00189</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> **</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Food          </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0.9986</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   0.5742</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   1.739</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0.08398</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> .</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Decor         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1.8824</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   0.3005</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   6.264</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 3.45e-09</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ***</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Service       </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0.7566</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   0.6489</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   1.166</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0.24536</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> East          </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">5.5702</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  10.3285</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   0.539</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0.59044</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Food</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">East     </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1.2679</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   0.7815</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   1.622</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0.10673</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Decor</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">East   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0.2791</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   0.4618</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0.604</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0.54646</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Service</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">East </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1.2842</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   0.8230</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1.560</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0.12071</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Residual standard error</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 5.747</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> on </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">157</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> degrees of freedom</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> observations deleted due to missingness)</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Multiple R</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">squared</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0.6381</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, Adjusted R</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">squared</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0.622</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> F</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">statistic</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 39.55</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> on </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> and </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">157</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> DF, p</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x3C;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2.2e-16</span></span></code></pre></figure><p>If we also do an ANOVA test,</p><figure data-rehype-pretty-code-figure=""><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0" data-language="r" data-theme="github-light github-dark"><code data-language="r" data-theme="github-light github-dark" style="display: grid;"><span data-line=""><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">anova</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(m1, m2)</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Analysis of Variance Table</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Model </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Price </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Food </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Decor </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> East</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Model </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Price </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Food </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Decor </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Service </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> East </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Food</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">East </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Decor</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">East </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Service</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">East</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   Service</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">East</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   Res.Df RSS Df Sum of Sq F </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">Pr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">F)</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 161</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 5338.9</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 157</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 5186.1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 152.82</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1.1566</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0.3322</span></span></code></pre></figure><p>This means we are happy to adopt the original reduced model.</p></section>
<section><h3 id="diagnostics-summary">Diagnostics Summary</h3><p>The main tools we will use to validate regression assumptions are,</p><ol>
<li>Plots involving <strong>standardized residuals</strong> and/or *<em>fitted values</em>.</li>
<li>Determine <strong>leverage points</strong></li>
<li>Determine which (if any) of the data points are <strong>outliers</strong>.</li>
<li>Asses the effect of each <em>predictor variable</em>, having adjusted for the effect of other predictor variables using <strong>added variable plots</strong>.</li>
<li>Asses the extent of <strong>collinearity</strong> among the predictor variables using <strong>variance inflation factors</strong>.</li>
<li>Examine whether the assumption of <strong>normality of error</strong> and <strong>constant error variance</strong> is reasonable.</li>
</ol><section><h4 id="leverage-points-and-residuals">Leverage Points and Residuals</h4><p>Remember from simple linear regression, leverage points are points that have extreme values of the predictor variable.</p><p>$$
\mathbf{\hat{Y}} = \mathbf{X} \hat{\beta} = \mathbf{X}(\mathbf{X}^T \mathbf{X})^{-1} \mathbf{X}^T \mathbf{Y} = \mathbf{H} \mathbf{Y},
$$</p><p>where $\mathbf{H} = \mathbf{X}(\mathbf{X} \mathbf{X})^{-1} \mathbf{X}^T$ (also called the hat matrix).</p><p>Let $h_{ij}$ be the $(i, j)$-entry of $\mathbf{H}$, then,</p><p>$$
\hat{Y_i} = h_{ii} Y_i + \sum_{j \neq i} h_{ij} Y_j
$$</p><p>The rule of thumb for leverage points are,</p><p>$$
h_{ii} > 2 \times \text{average}(h_{ii}) = 2 \times \frac{p+1}{n}
$$</p><p>The residuals are defined as,</p><p>$$
\mathbf{\hat{e}} = \mathbf{Y} - \mathbf{\hat{Y}} = (\mathbf{I} - \mathbf{H}) \mathbf{Y}
$$</p><p>We can show that,</p><p>$$
\text{Var}(\mathbf{\hat{e}} | \mathbf{X}) = \sigma^2(\mathbf{I} - \mathbf{H}),
$$</p><p>and that the standardized residuals are,</p><p>$$
r_i = \frac{\hat{e_i}}{s \sqrt{1 - h_{ii}}}
$$</p><p>where,</p><p>$$
s = \sqrt{\frac{\sum_{i=1}^n \hat{e_i^2}}{n - p - 1}}
$$</p><p>Any pattern in a residual plot indicates that an incorrect model has been fit, but the pattern in general does not provide direct information on how the model is misspecified.</p></section><section><h4 id="added-variable-plots">Added Variable Plots</h4><p>Assume we originally have the model,</p><p>$$
\mathbf{Y} \mathbf{X} \beta + \mathbf{e}.
$$</p><p>With an <em>additional predictor</em>, we now consider,</p><p>$$
\mathbf{Y} = \mathbf{X} \beta + \mathbf{Z} \alpha + \mathbf{e},
$$</p><p>where,</p><p>$$
\mathbf{Z} =
\begin{bmatrix}
z_1 \newline
z_2 \newline
\vdots \newline
z_n
\end{bmatrix}
$$</p><p>The procedure is as follows,</p><ol>
<li>Perform Regression
$$
\mathbf{Y} = \mathbf{X} \beta + \mathbf{e}
$$</li>
</ol><p>to get the residual $\mathbf{e}_{\mathbf{Y}.\mathbf{X}}$.</p><ol start="2">
<li>Perform Regression
$$
\mathbf{Z} = \mathbf{X} \beta + \mathbf{e}
$$</li>
</ol><p>to get residual $\mathbf{e}_{\mathbf{Z}.\mathbf{X}}$.</p><ol start="3">
<li>Plot $\mathbf{e}_{\mathbf{Y}.\mathbf{X}}$ (on $y$-axis)</li>
</ol><p>against $\mathbf{e}_{\mathbf{Z}.\mathbf{X}}$ (on $x$-axis).</p></section><section><h4 id="transformations">Transformations</h4><p>Transforming only $Y$ using inverse response plot.</p><p>Assume the true model is actually,</p><p>$$
Y = g(\beta_0 + \beta_1 x_1 + \ldots + \beta_p x_p + e),
$$</p><p>the inverse model is thus,</p><p>$$
g^{-1}(Y) = \beta_0 + \beta_1 x_1 + \ldots + \beta_p x_p + e
$$</p><p>To use inverse response plot, an important assumption is that the predictors are pairwise linearly related.</p><section><h5 id="example-defective-rates">Example: Defective rates.</h5><p>We want to develop a model for number of defectives based on $x_1$: temperature, $x_2$: density, and $x_3$: production rate.</p><p>To get the pairwise linear relationship, we can use the scatterplot matrix.</p><figure data-rehype-pretty-code-figure=""><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0" data-language="r" data-theme="github-light github-dark"><code data-language="r" data-theme="github-light github-dark" style="display: grid;"><span data-line=""><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">pairs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Defective </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Temperature </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Density </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Rate)</span></span></code></pre></figure><p>To get the inverse response plot, we can use the following code.</p><figure data-rehype-pretty-code-figure=""><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0" data-language="r" data-theme="github-light github-dark"><code data-language="r" data-theme="github-light github-dark" style="display: grid;"><span data-line=""><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">m1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">lm</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(Defective</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Temperature</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Density</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Rate)</span></span>
<span data-line=""><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">inverseResponsePlot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(m1)</span></span></code></pre></figure></section></section><section><h4 id="collinearity-of-predictors">Collinearity of Predictors</h4><p>When higly correlated predictor variables are included, they are effectively carrying very similar information about the response variable.</p><p>Thus, it is difficult for least squares to distinguish their separate effects on the response variable.</p><p>Some of the coefficients in the regression model are of the opposite sign than expected.</p><p>Consider the multiple regression model,</p><p>$$
Y = \beta_0 + \beta_1 x_1 + \ldots \beta_p x_p + e.
$$</p><p>Let $R_j^2$ be the coefficient of determination $R^2$ obtained when regressing $x_j$ on other predictors.</p><p>Then it can be shown that,</p><p>$$
\text{Var}(\hat{\beta_j}) = \frac{1}{1 - R_j^2} \frac{\sigma^2}{(n - 1) S_{x_j}^2}
$$</p><p>$\frac{1}{1 - R_j^2}$ is called the variance inflation factor.</p><p>A rough guide for identifying large VIF is to use the cut-off value 5.</p><p>What do you do when collinearity exists?</p><ol>
<li>Do nothing but be careful of interpretation.</li>
<li>Remove highly correlated variables (keep only one of them).</li>
</ol></section></section>


</body></html> </article> <div class="col-start-2"> <nav class="col-start-2 grid grid-cols-1 gap-4 sm:grid-cols-2"> <a href="#" target="_self" class="duration-300 ease-in-out gap-2 whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&#38;_svg]:pointer-events-none [&#38;_svg:not([class*='size-'])]:size-4 shrink-0 [&#38;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 px-4 py-2 has-[>svg]:px-3 rounded-xl group flex items-center justify-start size-full pointer-events-none opacity-50 cursor-not-allowed" aria-disabled="true">  <svg width="1em" height="1em" viewBox="0 0 24 24" class="mr-2 size-4 transition-transform group-hover:-translate-x-1" data-icon="lucide:arrow-left">   <use href="#ai:lucide:arrow-left"></use>  </svg> <div class="flex flex-col items-start overflow-hidden text-wrap"> <span class="text-muted-foreground text-left text-xs">Next Post</span> <span class="w-full text-left text-sm text-ellipsis"> Latest post! </span> </div>  </a> <a href="/cityu/ma3518/ma3518_4" target="_self" class="duration-300 ease-in-out gap-2 whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&#38;_svg]:pointer-events-none [&#38;_svg:not([class*='size-'])]:size-4 shrink-0 [&#38;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 px-4 py-2 has-[>svg]:px-3 rounded-xl group flex items-center justify-end size-full" aria-disabled="false">  <div class="flex flex-col items-end overflow-hidden text-wrap"> <span class="text-muted-foreground text-right text-xs">Previous Post</span> <span class="w-full text-right text-sm text-ellipsis"> Part 4 - Simple Linear Regression </span> </div> <svg width="1em" height="1em" viewBox="0 0 24 24" class="ml-2 size-4 transition-transform group-hover:translate-x-1" data-icon="lucide:arrow-right">   <use href="#ai:lucide:arrow-right"></use>  </svg>  </a> </nav> </div> <div class="col-start-2"> <div class="giscus"></div> <script data-astro-rerun src="https://giscus.app/client.js" data-repo="rezaarezvan/rezarezvan.com" data-repo-id="R_kgDOHvQr3w" data-category="General" data-category-id="DIC_kwDOHvQr384CiWVC" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="preferred_color_scheme" data-lang="en" data-loading="lazy" crossorigin="anonymous" async></script> </div> </section> <button data-slot="button" class="items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 size-9 group fixed right-8 bottom-8 z-50 hidden" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top"> <svg width="1em" height="1em" class="mx-auto size-4 transition-all group-hover:-translate-y-0.5" data-icon="lucide:arrow-up">   <symbol id="ai:lucide:arrow-up" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m5 12l7-7l7 7m-7 7V5"/></symbol><use href="#ai:lucide:arrow-up"></use>  </svg> </button> <script type="module">document.addEventListener("astro:page-load",()=>{const o=document.getElementById("scroll-to-top"),t=document.querySelector("footer");o&&t&&(o.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})}),window.addEventListener("scroll",()=>{const e=t.getBoundingClientRect().top<=window.innerHeight;o.classList.toggle("hidden",window.scrollY<=300||e)}))});</script>  </div> </main> <footer class="py-4"> <div class="mx-auto flex max-w-3xl flex-col items-center justify-center gap-y-2 px-4 sm:flex-row sm:justify-between"> <div class="flex flex-wrap items-center justify-center gap-x-2 text-center"> <span class="text-muted-foreground text-sm">
&copy; 2025 • rezarezvan.com </span> </div> </div> </footer> <div id="backdrop" class="invisible fixed top-0 left-0 z-50 flex h-screen w-full justify-center bg-[rgba(0,0,0,0.5)] p-6 backdrop-blur-sm" data-astro-transition-persist="astro-t6dxx5el-4"> <div id="pagefind-container" class="m-0 flex h-fit max-h-[80%] w-full max-w-screen-sm flex-col overflow-auto rounded border border-black/15 bg-neutral-100 p-2 px-4 py-3 shadow-lg dark:border-white/20 dark:bg-neutral-900"> <div id="search" class="pagefind-ui pagefind-init" data-pagefind-ui data-bundle-path="/pagefind/" data-ui-options="{&#34;showImages&#34;:false,&#34;excerptLength&#34;:15,&#34;resetStyles&#34;:false}"></div> <script type="module" src="/_astro/Search.astro_astro_type_script_index_0_lang.C4tRTXsn.js"></script> <div class="dark:prose-invert mr-2 pt-4 pb-1 text-right text-xs">
Press <span class="prose dark:prose-invert text-xs"><kbd class="">Esc</kbd></span> or click anywhere to close
</div> </div> </div> <script>
  document.addEventListener('DOMContentLoaded', () => {
    const magnifyingGlass = document.getElementById('magnifying-glass')
    const backdrop = document.getElementById('backdrop')

    function openPagefind() {
      const searchDiv = document.getElementById('search')
      const search = searchDiv.querySelector('input')
      setTimeout(() => {
        search.focus()
      }, 0)
      backdrop?.classList.remove('invisible')
      backdrop?.classList.add('visible')
    }

    function closePagefind() {
      const searchDiv = document.getElementById('search')
      const search = searchDiv.querySelector('input')
      if (search) {
        search.value = ''
      }
      backdrop?.classList.remove('visible')
      backdrop?.classList.add('invisible')
    }

    // open pagefind
    magnifyingGlass?.addEventListener('click', () => {
      openPagefind()
    })

    document.addEventListener('keydown', (e) => {
      if (e.key === '/') {
        e.preventDefault()
        openPagefind()
      } else if ((e.metaKey || e.ctrlKey) && e.key === 'k') {
        e.preventDefault()
        openPagefind()
      }
    })

    // close pagefind
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        closePagefind()
      }
    })

    // close pagefind when searched result(link) clicked
    document.addEventListener('click', (event) => {
      if (event.target.classList.contains('pagefind-ui__result-link')) {
        closePagefind()
      }
    })

    backdrop?.addEventListener('click', (event) => {
      if (!event.target.closest('#pagefind-container')) {
        closePagefind()
      }
    })

    // prevent form submission
    const form = document.getElementById('form')
    form?.addEventListener('submit', (event) => {
      event.preventDefault()
    })
  })
</script>  </div> </body></html>