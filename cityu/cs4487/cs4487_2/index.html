<!DOCTYPE html><html lang="en"> <head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"><meta name="generator" content="Astro v5.7.4"><meta name="robots" content="index, follow"><meta name="HandheldFriendly" content="True"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="format-detection" content="telephone=no,date=no,address=no,email=no,url=no"><meta name="theme-color" content="#121212" media="(prefers-color-scheme: dark)"><meta name="theme-color" content="#121212" media="(prefers-color-scheme: light)"><link rel="sitemap" href="/sitemap-index.xml"><link rel="manifest" href="/site.webmanifest"><link rel="alternate" type="application/rss+xml" title="rezarezvan.com" href="https://rezaarezvan.com/rss.xml"><!-- PageFind --><link href="/pagefind/pagefind-ui.css" rel="stylesheet"><script src="/pagefind/pagefind-ui.js"></script><!-- KaTeX support --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css" integrity="sha384-5TcZemv2l/9On385z///+d7MSYlvIEw9FuZTIdZ14vJLqWphw7e7ZPuOiCHJcFCP" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js" integrity="sha384-cMkvdD8LoxVzGF/RPUKAcvmm49FQ0oxwDF3BGKtDXcEc+T1b2N+teh/OJfpU0jr6" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js" integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><!-- inline KaTeX --><script>
    function renderKaTeX() {
      if (typeof renderMathInElement !== 'undefined') {
        renderMathInElement(document.body, {
          delimiters: [
            { left: '$$', right: '$$', display: true },
            { left: '$', right: '$', display: false },
          ],
        })
      }
    }

    document.addEventListener('DOMContentLoaded', renderKaTeX)
    document.addEventListener('astro:after-swap', renderKaTeX)
  </script><link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96"><link rel="icon" type="image/svg+xml" href="/favicon.ico"><link rel="shortcut icon" href="/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><meta name="apple-mobile-web-app-title" content="rezvan-blog"><link rel="manifest" href="/site.webmanifest"><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><script type="module" src="/_astro/ClientRouter.astro_astro_type_script_index_0_lang.BZs-2RF_.js"></script><script>
    function init() {
      setGiscusTheme()
    }

    const setGiscusTheme = () => {
      const giscus = document.querySelector('.giscus-frame')

      const isDark = document.documentElement.classList.contains('dark')

      if (giscus) {
        const url = new URL(giscus.src)
        url.searchParams.set('theme', isDark ? 'dark' : 'light')
        giscus.src = url.toString()
      }
    }

    document.addEventListener('DOMContentLoaded', () => init())
    document.addEventListener('astro:after-swap', () => init())
  </script><title>Part 2 - Generative VS. Discriminative Models | rezarezvan.com</title><meta name="title" content="Part 2 - Generative VS. Discriminative Models | rezarezvan.com"><meta name="description" content="Personal website and course notes repository"><link rel="canonical" href="https://rezarezvan.com"><meta property="og:title" content="Part 2 - Generative VS. Discriminative Models"><meta property="og:description" content="Personal website and course notes repository"><meta property="og:image" content="https://rezarezvan.comundefined"><meta property="og:image:alt" content="Part 2 - Generative VS. Discriminative Models"><meta property="og:type" content="website"><meta property="og:locale" content="en"><meta property="og:site_name" content="rezarezvan.com"><meta property="og:url" content="https://rezaarezvan.com/cityu/cs4487/cs4487_2/"><meta name="twitter:title" content="Part 2 - Generative VS. Discriminative Models"><meta name="twitter:description" content="Personal website and course notes repository"><meta property="twitter:image" content="https://rezarezvan.comundefined"><meta name="twitter:image:alt" content="Part 2 - Generative VS. Discriminative Models"><meta name="twitter:card" content="summary_large_image"><link rel="stylesheet" href="/_astro/index.CBETSR-o.css"></head><body> <div class="flex h-fit min-h-screen flex-col gap-y-6 font-sans"> <header class="bg-background/50 sticky top-0 z-10 backdrop-blur-md" data-astro-transition-persist="astro-l7r54iwe-1"> <div class="mx-auto flex max-w-3xl flex-wrap items-center justify-between gap-4 p-4"> <a href="/" target="_self" class="transition-colors duration-300 ease-in-out flex shrink-0 items-center gap-2 text-xl font-medium"> rezarezvan.com </a> <div class="flex items-center gap-2 md:gap-4"> <nav class="hidden items-center gap-4 text-sm sm:gap-6 md:flex"> <a href="/blog" target="_self" class="inline-block duration-300 ease-in-out hover:text-foreground/30 transition-colors"> blog<span>/</span>  </a><a href="/chalmers" target="_self" class="inline-block duration-300 ease-in-out hover:text-foreground/30 transition-colors"> chalmers<span>/</span>  </a><a href="/cityu" target="_self" class="inline-block duration-300 ease-in-out hover:text-foreground/30 transition-colors"> cityu<span>/</span>  </a><a href="/about" target="_self" class="inline-block duration-300 ease-in-out hover:text-foreground/30 transition-colors"> about<span>/</span>  </a><a href="/research" target="_self" class="inline-block duration-300 ease-in-out hover:text-foreground/30 transition-colors"> research<span>/</span>  </a> </nav> <button id="magnifying-glass" aria-label="Search" class="flex items-center rounded border border-black/15 bg-neutral-100 px-2 py-1 text-xs transition-colors duration-300 ease-in-out hover:bg-black/5 hover:text-black focus-visible:bg-black/5 focus-visible:text-black dark:border-white/20 dark:bg-neutral-900 dark:hover:bg-white/5 dark:hover:text-white dark:focus-visible:bg-white/5 dark:focus-visible:text-white"> <svg height="16" stroke-linejoin="round" viewBox="0 0 16 16" width="16" style="color: currentcolor;"> <path fill-rule="evenodd" clip-rule="evenodd" d="M3.5 7C3.5 5.067 5.067 3.5 7 3.5C8.933 3.5 10.5 5.067 10.5 7C10.5 7.88461 10.1718 8.69256 9.63058 9.30876L9.30876 9.63058C8.69256 10.1718 7.88461 10.5 7 10.5C5.067 10.5 3.5 8.933 3.5 7ZM9.96544 11.0261C9.13578 11.6382 8.11014 12 7 12C4.23858 12 2 9.76142 2 7C2 4.23858 4.23858 2 7 2C9.76142 2 12 4.23858 12 7C12 8.11014 11.6382 9.13578 11.0261 9.96544L14.0303 12.9697L14.5607 13.5L13.5 14.5607L12.9697 14.0303L9.96544 11.0261Z" fill="currentColor"></path> </svg>
&nbsp;Search
</button> <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();;(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t),11:t=>1/0*t},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="Z2dJ8uD" prefix="r4" component-url="/_astro/mobile-menu.DemvBhyx.js" component-export="default" renderer-url="/_astro/client.BG4G8VrZ.js" props="{&quot;data-astro-transition-persist&quot;:[0,&quot;astro-lci6dfah-2&quot;]}" ssr client="load" opts="{&quot;name&quot;:&quot;MobileMenu&quot;,&quot;value&quot;:true}" data-astro-transition-persist="astro-lci6dfah-2" await-children><button data-slot="dropdown-menu-trigger" class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 size-9 md:hidden" title="Menu" type="button" id="radix-:r4R0:" aria-haspopup="menu" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu h-5 w-5"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg><span class="sr-only">Toggle menu</span></button><!--astro:end--></astro-island> <button data-slot="button" class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 size-9" id="theme-toggle" title="Toggle theme"> <svg width="1em" height="1em" class="size-4 scale-100 rotate-0 transition-all dark:scale-0 dark:-rotate-90" data-icon="lucide:sun">   <symbol id="ai:lucide:sun" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><circle cx="12" cy="12" r="4"/><path d="M12 2v2m0 16v2M4.93 4.93l1.41 1.41m11.32 11.32l1.41 1.41M2 12h2m16 0h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41"/></g></symbol><use href="#ai:lucide:sun"></use>  </svg> <svg width="1em" height="1em" class="absolute size-4 scale-0 rotate-90 transition-all dark:scale-100 dark:rotate-0" data-icon="lucide:moon">   <symbol id="ai:lucide:moon" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3a6 6 0 0 0 9 9a9 9 0 1 1-9-9"/></symbol><use href="#ai:lucide:moon"></use>  </svg> <span class="sr-only">Toggle theme</span> </button> <script data-astro-rerun>
  const theme = (() => {
    const localStorageTheme = localStorage?.getItem('theme') ?? ''
    if (['dark', 'light'].includes(localStorageTheme)) {
      return localStorageTheme
    }
    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
      return 'dark'
    }
    return 'light'
  })()

  if (theme === 'light') {
    document.documentElement.classList.remove('dark')
  } else {
    document.documentElement.classList.add('dark')
  }

  window.localStorage.setItem('theme', theme)
</script> <script type="module">function a(){const e=document.documentElement;e.classList.add("disable-transitions"),e.classList.toggle("dark"),window.getComputedStyle(e).getPropertyValue("opacity"),requestAnimationFrame(()=>{e.classList.remove("disable-transitions")});const t=e.classList.contains("dark");localStorage.setItem("theme",t?"dark":"light")}function s(){const e=document.getElementById("theme-toggle");e&&e.addEventListener("click",a)}s();document.addEventListener("astro:after-swap",()=>{const e=localStorage.getItem("theme"),t=document.documentElement;t.classList.add("disable-transitions"),window.getComputedStyle(t).getPropertyValue("opacity"),e==="dark"?t.classList.add("dark"):t.classList.remove("dark"),requestAnimationFrame(()=>{t.classList.remove("disable-transitions")}),s()});</script> </div> </div> </header> <main class="grow"> <div class="mx-auto flex grow flex-col gap-y-6 px-4">   <section class="grid grid-cols-[minmax(0px,1fr)_min(calc(var(--breakpoint-md)-2rem),100%)_minmax(0px,1fr)] gap-y-6"> <div class="col-start-2"> <nav aria-label="breadcrumb" data-slot="breadcrumb"> <ol data-slot="breadcrumb-list" class="text-muted-foreground flex flex-wrap items-center gap-1.5 text-sm break-words sm:gap-2.5"> <li data-slot="breadcrumb-item" class="inline-flex items-center gap-1.5"> <a data-slot="breadcrumb-link" class="hover:text-foreground transition-colors" href="/"> <svg width="1em" height="1em" class="size-4" data-icon="lucide:home">   <symbol id="ai:lucide:home" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8"/><path d="M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/></g></symbol><use href="#ai:lucide:home"></use>  </svg> </a> </li>  <li data-slot="breadcrumb-separator" role="presentation" aria-hidden="true" class="[&amp;&gt;svg]:size-3.5"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.1584 3.13508C6.35985 2.94621 6.67627 2.95642 6.86514 3.15788L10.6151 7.15788C10.7954 7.3502 10.7954 7.64949 10.6151 7.84182L6.86514 11.8418C6.67627 12.0433 6.35985 12.0535 6.1584 11.8646C5.95694 11.6757 5.94673 11.3593 6.1356 11.1579L9.565 7.49985L6.1356 3.84182C5.94673 3.64036 5.95694 3.32394 6.1584 3.13508Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></li> <li data-slot="breadcrumb-item" class="inline-flex items-center gap-1.5"><a data-slot="breadcrumb-link" class="hover:text-foreground transition-colors" href="/cityu"> <span class="flex items-center gap-x-2"> <svg width="1em" height="1em" class="size-4" data-icon="lucide:graduation-cap">   <symbol id="ai:lucide:graduation-cap" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0zM22 10v6"/><path d="M6 12.5V16a6 3 0 0 0 12 0v-3.5"/></g></symbol><use href="#ai:lucide:graduation-cap"></use>  </svg> CityU </span> </a></li>  <li data-slot="breadcrumb-separator" role="presentation" aria-hidden="true" class="[&amp;&gt;svg]:size-3.5"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.1584 3.13508C6.35985 2.94621 6.67627 2.95642 6.86514 3.15788L10.6151 7.15788C10.7954 7.3502 10.7954 7.64949 10.6151 7.84182L6.86514 11.8418C6.67627 12.0433 6.35985 12.0535 6.1584 11.8646C5.95694 11.6757 5.94673 11.3593 6.1356 11.1579L9.565 7.49985L6.1356 3.84182C5.94673 3.64036 5.95694 3.32394 6.1584 3.13508Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></li> <li data-slot="breadcrumb-item" class="inline-flex items-center gap-1.5"><a data-slot="breadcrumb-link" class="hover:text-foreground transition-colors" href="/cityu/cs4487"> <span class="flex items-center gap-x-2"> <svg width="1em" height="1em" class="size-4" data-icon="lucide:book-open">   <symbol id="ai:lucide:book-open" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 7v14m-9-3a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4a4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3a3 3 0 0 0-3-3z"/></symbol><use href="#ai:lucide:book-open"></use>  </svg> Machine Learning </span> </a></li>  <li data-slot="breadcrumb-separator" role="presentation" aria-hidden="true" class="[&amp;&gt;svg]:size-3.5"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.1584 3.13508C6.35985 2.94621 6.67627 2.95642 6.86514 3.15788L10.6151 7.15788C10.7954 7.3502 10.7954 7.64949 10.6151 7.84182L6.86514 11.8418C6.67627 12.0433 6.35985 12.0535 6.1584 11.8646C5.95694 11.6757 5.94673 11.3593 6.1356 11.1579L9.565 7.49985L6.1356 3.84182C5.94673 3.64036 5.95694 3.32394 6.1584 3.13508Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></li> <li data-slot="breadcrumb-item" class="inline-flex items-center gap-1.5"><span data-slot="breadcrumb-page" role="link" aria-disabled="true" aria-current="page" class="text-foreground font-normal"> <span class="flex items-center gap-x-2"> <svg width="1em" height="1em" class="size-4" data-icon="lucide:file-text">   <symbol id="ai:lucide:file-text" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/><path d="M14 2v4a2 2 0 0 0 2 2h4M10 9H8m8 4H8m8 4H8"/></g></symbol><use href="#ai:lucide:file-text"></use>  </svg> Part 2 - Generative VS. Discriminative Models </span> </span></li> </ol> </nav> </div>  <section class="col-start-2 flex flex-col gap-y-6 text-center"> <div class="flex flex-col"> <h1 class="mb-2 text-4xl leading-tight font-medium text-pretty sm:text-5xl"> Part 2 - Generative VS. Discriminative Models </h1> <div class="text-muted-foreground mb-4 flex flex-wrap items-center justify-center gap-2 text-sm"> <div class="flex items-center gap-2"> <span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden text-foreground [a&amp;]:hover:bg-accent [a&amp;]:hover:text-accent-foreground">CS4487</span> <div data-orientation="vertical" role="none" data-slot="separator-root" class="bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px h-4!"></div> <span>September 11, 2024</span> <div data-orientation="vertical" role="none" data-slot="separator-root" class="bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px h-4!"></div>  <div data-orientation="vertical" role="none" data-slot="separator-root" class="bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px h-4!"></div> <span>11 min read</span> </div> </div> </div> <nav class="col-start-2 grid grid-cols-1 gap-4 sm:grid-cols-2"> <a href="/cityu/cs4487/cs4487_3" target="_self" class="duration-300 ease-in-out gap-2 whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&#38;_svg]:pointer-events-none [&#38;_svg:not([class*='size-'])]:size-4 shrink-0 [&#38;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 px-4 py-2 has-[>svg]:px-3 rounded-xl group flex items-center justify-start size-full" aria-disabled="false">  <svg width="1em" height="1em" class="mr-2 size-4 transition-transform group-hover:-translate-x-1" data-icon="lucide:arrow-left">   <symbol id="ai:lucide:arrow-left" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m12 19l-7-7l7-7m7 7H5"/></symbol><use href="#ai:lucide:arrow-left"></use>  </svg> <div class="flex flex-col items-start overflow-hidden text-wrap"> <span class="text-muted-foreground text-left text-xs">Next Post</span> <span class="w-full text-left text-sm text-ellipsis"> Part 3 - Optimization and Convexity </span> </div>  </a> <a href="/cityu/cs4487/cs4487" target="_self" class="duration-300 ease-in-out gap-2 whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&#38;_svg]:pointer-events-none [&#38;_svg:not([class*='size-'])]:size-4 shrink-0 [&#38;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 px-4 py-2 has-[>svg]:px-3 rounded-xl group flex items-center justify-end size-full" aria-disabled="false">  <div class="flex flex-col items-end overflow-hidden text-wrap"> <span class="text-muted-foreground text-right text-xs">Previous Post</span> <span class="w-full text-right text-sm text-ellipsis"> Part 1 - Introduction </span> </div> <svg width="1em" height="1em" class="ml-2 size-4 transition-transform group-hover:translate-x-1" data-icon="lucide:arrow-right">   <symbol id="ai:lucide:arrow-right" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14m-7-7l7 7l-7 7"/></symbol><use href="#ai:lucide:arrow-right"></use>  </svg>  </a> </nav> </section> <details open class="group col-start-2 rounded-xl border p-4 xl:sticky xl:top-20 xl:col-start-1 xl:mr-8 xl:ml-auto xl:h-[calc(100vh-5rem)] xl:max-w-fit xl:rounded-none xl:border-none xl:p-0"> <summary class="flex cursor-pointer items-center justify-between text-xl font-medium group-open:pb-4 xl:hidden"> <span>Table of Contents</span> <svg width="1em" height="1em" class="size-5 shrink-0 transition-transform group-open:rotate-180" data-icon="lucide:chevron-down">   <symbol id="ai:lucide:chevron-down" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m6 9l6 6l6-6"/></symbol><use href="#ai:lucide:chevron-down"></use>  </svg> </summary> <astro-island uid="1pLWCq" prefix="r8" component-url="/_astro/scroll-area.xjvopPPz.js" component-export="ScrollArea" renderer-url="/_astro/client.BG4G8VrZ.js" props="{&quot;className&quot;:[0,&quot;flex max-h-64 flex-col overflow-y-auto xl:max-h-[calc(100vh-8rem)]&quot;],&quot;type&quot;:[0,&quot;always&quot;]}" ssr client="load" opts="{&quot;name&quot;:&quot;ScrollArea&quot;,&quot;value&quot;:true}" await-children><div dir="ltr" data-slot="scroll-area" class="relative flex max-h-64 flex-col overflow-y-auto xl:max-h-[calc(100vh-8rem)]" style="position:relative;--radix-scroll-area-corner-width:0px;--radix-scroll-area-corner-height:0px"><style>[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}</style><div data-radix-scroll-area-viewport="" data-slot="scroll-area-viewport" class="ring-ring/10 dark:ring-ring/20 dark:outline-ring/40 outline-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] focus-visible:ring-4 focus-visible:outline-1" style="overflow-x:hidden;overflow-y:hidden"><div style="min-width:100%;display:table"><astro-slot> <ul class="flex list-none flex-col gap-y-2 px-4 xl:mr-8" id="table-of-contents"> <li class="hidden text-lg font-medium xl:block">Table of Contents</li> <li class="text-foreground/60 px-4 text-sm xl:p-0 ml-4"> <a href="#the-bayes-optimal-classifier" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> The Bayes Optimal Classifier </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-4"> <a href="#naive-bayes-classifier" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Naive Bayes Classifier </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-4"> <a href="#gaussian-classifier" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Gaussian Classifier </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-8"> <a href="#geometric-interpretation" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Geometric Interpretation </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-4"> <a href="#naive-bayes-for-boolean-vectors" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Naive Bayes for Boolean Vectors </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-8"> <a href="#smoothing" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Smoothing </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-4"> <a href="#multinomial-naive-bayes" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Multinomial Naive Bayes </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-4"> <a href="#linear-discriminant-analysis-lda" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Linear Discriminant Analysis (LDA) </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-4"> <a href="#training-lda" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Training LDA </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-8"> <a href="#geometric-interpretation-1" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Geometric Interpretation </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-4"> <a href="#naive-bayes-vs-lda" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Naive Bayes vs LDA </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-4"> <a href="#summary-of-generative-models" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Summary of Generative Models </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-4"> <a href="#discriminative-models" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Discriminative Models </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-8"> <a href="#linear-classifier" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Linear Classifier </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-12"> <a href="#geometric-interpretation-2" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Geometric Interpretation </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-12"> <a href="#separating-hyperplane" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Separating Hyperplane </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-4"> <a href="#training-a-linear-classifier" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Training a Linear Classifier </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-4"> <a href="#logistic-regression" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Logistic Regression </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-8"> <a href="#learning-the-parameters" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Learning the Parameters </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-12"> <a href="#logistic-loss-function" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Logistic Loss Function </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-4"> <a href="#cross-validation" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Cross-Validation </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-8"> <a href="#cross-validation-algorithm" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Cross-Validation Algorithm </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-4"> <a href="#multiclass-classification" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Multiclass Classification </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-8"> <a href="#one-vs-rest" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> One-vs-Rest </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-4"> <a href="#multiclass-logistic-regression" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Multiclass Logistic Regression </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-8"> <a href="#geometry-of-multiclass-logistic-regression" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Geometry of Multiclass Logistic Regression </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-4"> <a href="#logistic-regression-vs-nb-and-lda" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Logistic Regression VS. NB and LDA </a> </li><li class="text-foreground/60 px-4 text-sm xl:p-0 ml-8"> <a href="#logistic-regression-summary" class="marker:text-foreground/30 list-item list-disc underline decoration-transparent underline-offset-[3px] transition-colors duration-200 hover:decoration-inherit xl:list-none"> Logistic Regression Summary </a> </li> </ul> </astro-slot></div></div><div data-orientation="vertical" data-slot="scroll-area-scrollbar" class="flex touch-none p-px transition-colors select-none h-full w-2.5 border-l border-l-transparent" style="position:absolute;top:0;right:0;bottom:var(--radix-scroll-area-corner-height);--radix-scroll-area-thumb-height:18px"></div></div><!--astro:end--></astro-island> </details> <script type="module">function s(){const t=document.querySelector("header"),c=t?t.offsetHeight:0,a=new IntersectionObserver(e=>{e.forEach(o=>{const r=o.target.querySelector("h2, h3, h4, h5, h6");if(!r)return;const d=r.getAttribute("id"),n=document.querySelector(`#table-of-contents li a[href="#${d}"]`);if(!n)return;const i=o.isIntersecting?"add":"remove";n.classList[i]("text-foreground")})},{rootMargin:`-${c}px 0px 0px 0px`});document.querySelectorAll(".prose section").forEach(e=>{a.observe(e)})}document.addEventListener("astro:page-load",s);document.addEventListener("astro:after-swap",s);</script> <article class="prose col-start-2 max-w-none"> <!doctype html><html lang="en"><head></head><body>


<meta charset="utf-8">
<title>CS4487_2</title>
<meta content="width=device-width, initial-scale=1" name="viewport">
<link href="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css" rel="stylesheet">


<section><h3 id="the-bayes-optimal-classifier">The Bayes Optimal Classifier</h3><p>Recall from the previous part, that the best classifier, in theory, is the Bayes Optimal Classifier.
However, it is not useful in reality due to the difficulty of estimating $p(\mathbf{x} | y = c)$ in practice.</p></section>
<section><h3 id="naive-bayes-classifier">Naive Bayes Classifier</h3><p>The Naive Bayes classifier is a simplified version of the Bayes Optimal Classifier.</p><p>It has the <em>Naive Bayes assumption</em>, which assumes that all of the feature dimensions are statistically independant given the value of the class variable, for example,
$$
p(x_1, x_2 | y) = p(x_1 | y) p(x_2 | y)
$$</p><p>It also accumulates evidence from each feature dimension,
$$
\log p(x_1, x_2 | y) = \log p(x_1 | y) + \log p(x_2 | y)
$$</p><p>This allows us to model each dimension of the observation with a simple univariate distribution.</p><p>Therefore, the general form for the classification is,
$$
f_{NB}(\mathbf{x}) = \underset{c \in \{1, \ldots, C\}}{\arg\max} p(y = c) \prod_{j = 1}^{N} p(x_j | y = c)
$$</p></section>
<section><h3 id="gaussian-classifier">Gaussian Classifier</h3><p>If we treat each dimension as an independent Gaussian and fit the Gaussian parameters with MLE, we have a Gaussian classifier.</p><p>But what is the geometry of the decision boundary, let’s take a look at the 2D case.</p><section><h4 id="geometric-interpretation">Geometric Interpretation</h4><p>We can rewrite and simplify our equation,
$$
\begin{align*}
f_{NB}(\mathbf{x}) &#x26;= \underset{c \in \{1, 2\}}{\arg\max} p(y = c) \prod_{j = 1}^{2} p(x_j | y = c) \newline
&#x26;= \underset{c \in \{1, 2\}}{\arg\max} \log p(y = c) + \sum_{j = 1}^{2} \log p(x_j | y = c) \newline
&#x26;= \underset{c \in \{1, 2\}}{\arg\max} \log p(y = c) + \sum_{j = 1}^{2} \log \mathcal{N}(x_j; \mu_{j | c}, \sigma_{j | c}^2) \newline
&#x26;= \underset{c \in \{1, 2\}}{\arg\max} \log p(y = c) + \sum_{j = 1}^{2} \log \left[ \frac{1}{\sqrt{2\pi\sigma_{j | c}^2}} \exp\left(-\frac{(x_j - \mu_{j | c})^2}{2\sigma_{j | c}^2}\right) \right] \newline
&#x26;= \underset{c \in \{1, 2\}}{\arg\max} \log p(y = c) + \sum_{j = 1}^{2} \log \left[\left(2\pi\sigma_{j | c}^2\right)^{-\frac{1}{2}} \exp\left(-\frac{(x_j - \mu_{j | c})^2}{2\sigma_{j | c}^2}\right) \right] \newline
&#x26;= \underset{c \in \{1, 2\}}{\arg\max} \log p(y = c) + \sum_{j = 1}^{2} \left( -\frac{1}{2} \log(2\pi\sigma_{j | c}^2) - \frac{(x_j - \mu_{j | c})^2}{2\sigma_{j | c}^2} \right)
\end{align*}
$$</p><p>Okay, so the decision boundary consists of the set of points $(x_1, x_2)$ where,
$$
\log p(y = 1) + \sum_{j = 1}^2 \log p(x_j | y = 1) = \log p(y = 2) + \sum_{j = 1}^2 \log p(x_j | y = 2)
$$</p><p>Which means,
$$
\log p(y = 1) + \sum_{j = 1}^2 \left(-\frac{1}{2} \log(2\pi\sigma_{j | 1}^2) - \frac{(x_j - \mu_{j | 1})^2}{2\sigma_{j | 1}^2}\right) - \newline \log p(y = 2) + \sum_{j = 1}^2 \left(-\frac{1}{2} \log(2\pi\sigma_{j | 2}^2) - \frac{(x_j - \mu_{j | 2})^2}{2\sigma_{j | 2}^2}\right) \newline = 0
$$</p><p>So it is a quadratic function of $(x_1, x_2)$ with the form,
$$
\sum_{j = 1}^2 (a_j x_j^2 + b_j x_j) + c = 0
$$</p></section></section>
<section><h3 id="naive-bayes-for-boolean-vectors">Naive Bayes for Boolean Vectors</h3><p>In the case we are working with boolean vectors, we can simplify the Naive Bayes classifier.</p><p>We still model each feature independently, but we can use the Bernoulli distribution to model the feature.</p><p>If there is a presence of a feature, we model it as,
$$
p(x_j = 1 | y = c) = \varphi_{j | c}
$$</p><p>and in the absence of a feature, we model it as,
$$
p(x_j = 0 | y = c) = 1 - \varphi_{j | c}
$$</p><p>Therefore, the MLE parameters are $\varphi_{j | c} = M_{j | c} / M_c$, where,
$M_{j | c}$ is the number of training examples in class $c$ that contain feature $x_j$.
$M_c$ is the number of training examples in class $c$.</p><p>We therefore get class-conditional distributions,
$$
p(x_1, \ldots, x_N | y = c) = \prod_{j = 1}^{N} p(x_j | y = c) \newline
\log p(x_1, \ldots, x_N | y = c) = \sum_{j = 1}^{N} \log p(x_j | y = c)
$$</p><p>So, for an input example $\mathbf{x}$, the log-probabilities of features present given $y = c$ adds.</p><section><h4 id="smoothing">Smoothing</h4><p>Some features may not be present in any training examples for a given class, which means, $M_{j | c} = 0$ and thus $\varphi_{j | c} = 0$.</p><p>Which is problematic, since it may appear in a real-world example.</p><p>To solve this we need to smooth our MLE, by adding a <em>smoothing parameter</em> $\alpha$, which can be interpreted as a “pseudo-count”.</p><p>So, our new parameter is,
$$
\varphi_{j | c} = \frac{M_{j | c} + \alpha}{M_c + N\alpha}
$$</p><p>If $\alpha = 1$, then we have <em>Laplace Smoothing</em> (also called additive smoothing).</p><p>In general, smoothing helps to prevent <strong>overfitting</strong> of the parameters.</p></section></section>
<section><h3 id="multinomial-naive-bayes">Multinomial Naive Bayes</h3><p>What if $x_j$ has a finite set of categories?
$$
x_j \in \chi_j = \{1, \ldots, | \chi_j |\}
$$</p><p>Then we need to use a multinomial (or categorical) distribution as class-conditional,
$$
p(x_j = k | y = c) = \varphi_{x, j | c} \newline
\sum_{x \in \chi_j} \varphi_{x, j | c} = 1
$$</p><p>Our MLE parameter, $\varphi_{x, j | c} = M_{x, j | c} / M_{j | c}$, where,
$M_{x, j | c}$ is the number of training examples in class $c$ that have feature $x_j = x$.
$M_{j | c}$ is the number of training examples in class $c$.</p></section>
<section><h3 id="linear-discriminant-analysis-lda">Linear Discriminant Analysis (LDA)</h3><p>LDA is a classification technique that dates back to the 1930s, with origins from Fisher.</p><p>It can be interpreted as a approximation to the Bayes optimal classifier, but for real-valued data.</p><p>Instead of a product of independent Gaussians, LDA assumes that $p(\mathbf{x} | y = c) = \mathcal{N}(\mathbf{x}; \mathbf{\mu}_c, \mathbf{\Sigma})$.
A multivariate Gaussian with a shared covariance matrix $\mathbf{\Sigma}$.</p><p>Which equates to,
$$
p(\mathbf{x} | y = c) = \frac{1}{|(2\pi)^N \mathbf{\Sigma}}|^{\frac{1}{2}} exp\left(-\frac{1}{2} (\mathbf{x} - \mathbf{\mu}_c)^T \mathbf{\Sigma}^{-1} (\mathbf{x} - \mathbf{\mu}_c)\right)
$$</p><p>The classification function is then,
$$
f_{LDA}(\mathbf{x}) = \underset{c \in \{1, \ldots, C\}}{\arg\max} p(y = c) p(\mathbf{x} | y = c)
$$</p></section>
<section><h3 id="training-lda">Training LDA</h3><p>As with Naive Bayes, the LDA parameters are learned using MLE.</p><p>Our class probabilities are,
$$
p(y = c) = \frac{1}{M} \sum_{i = 1}^{M} \mathbb{I}(y^{(i)} = c) = \frac{M_c}{M}
$$</p><p>Class means are,
$$
\mathbf{\mu_c} = \frac{\sum_{i = 1}^M \mathbb{I}(y^{(i)} = c) \mathbf{x}^{(i)}}{\sum_{i = 1}^M \mathbb{I}[y^{(i)} = c]} = \frac{\sum_{i = 1}^{M_c} \mathbf{x}^{(i)}}{M_c}
$$</p><p>where $\mathbf{x}^{(i)}$ belongs to class $c$.</p><p>The shared covariance matrix is,
$$
\mathbf{\Sigma} = \frac{1}{M} \sum_{i = 1}^M \left(\mathbf{x}^{(i)} - \mathbf{\mu_{y^{(i)}}}\right) \left(\mathbf{x}^{(i)} - \mathbf{\mu_{y^{(i)}}}\right)^T
$$</p><section><h4 id="geometric-interpretation-1">Geometric Interpretation</h4><p>Let’s take a look at the geometry of the decision boundry for LDAs.</p><p>The decision boundary is the set of points $\mathbf{x}$ where,
$$
\log p(y = 1) - \frac{1}{2} \log |(2\pi)^2 \mathbf{\Sigma}| - \frac{1}{2}(\mathbf{x} - \mathbf{\mu}_1)^T \mathbf{\Sigma}^{-1} (\mathbf{x} - \mathbf{\mu}_1) \newline - \log p(y = 2) - \frac{1}{2} \log |(2\pi)^2 \mathbf{\Sigma}| - \frac{1}{2}(\mathbf{x} - \mathbf{\mu}_2)^T \mathbf{\Sigma}^{-1} (\mathbf{x} - \mathbf{\mu}_2) = 0
$$</p><p>By cancelling out the common terms, we get,
$$
\log \frac{p(y = 1)}{p(y = 2)} - \frac{1}{2} \mathbf{\mu}_1^T \mathbf{\Sigma}^{-1} \mathbf{\mu}_1 + \frac{1}{2} \mathbf{\mu}_2^T \mathbf{\Sigma}^{-1} \mathbf{\mu}_2 + (\mathbf{\mu}_1 - \mathbf{\mu}_2)^T \mathbf{\Sigma}^{-1} \mathbf{x} = 0
$$</p><p>This shows that the decision boundary is linear in $\mathbf{x}$.</p></section></section>
<section><h3 id="naive-bayes-vs-lda">Naive Bayes vs LDA</h3><p>So, which is better?</p><p>Let’s break it down.</p><ul>
<li>Storage
<ul>
<li>Naive Bayes: $\mathcal{O}(N)$ parameters</li>
<li>LDA: $\mathcal{O}(N^2)$ parameters</li>
</ul>
</li>
<li>Speed
The quadratic dependence on N makes LDA slower than NB during learning and classification.</li>
<li>Interpretability
<ul>
<li>Both models have good interpretability since the parameters of $p(\mathbf{x} | y = c)$ corresponds to class conditional averages.</li>
</ul>
</li>
<li>Data
<ul>
<li>LDA will generally need more data than NB since it needs to estimate $\mathcal{O}(N^2)$ parameters in the shared covariance matrix.</li>
</ul>
</li>
</ul></section>
<section><h3 id="summary-of-generative-models">Summary of Generative Models</h3><p>So, what we have been looking at can also be called <em>generative classification models</em>.</p><p>They estimate a probability distribution of features from each class.
Given a feature, predict the class with the largest posterior probability.</p><ul>
<li>Advantages
<ul>
<li>Works with small amounts of data.</li>
<li>Works with multiple classes.</li>
</ul>
</li>
<li>Disadvantages
<ul>
<li>Accuracy depends on selecting an appropriate probability distribution.</li>
<li>If the probability distribution can’t model the data, the accuracy will be poor.</li>
</ul>
</li>
</ul></section>
<section><h3 id="discriminative-models">Discriminative Models</h3><p>Discriminative models directly model the posterior probability $p(y | \mathbf{x})$.</p><p>Let’s start with the simplest discriminative model, the <em>linear classifier</em>.</p><section><h4 id="linear-classifier">Linear Classifier</h4><p>For a linear classifier we have this “setup”.
Observation (feature vectors) $\mathbf{x} \in \mathbb{R}^N$.
Class $y \in \{-1, +1\}$.</p><p>Our goal is to calculate a linear function of the feature vector $\mathbf{x}$,
$$
f(\mathbf{x}) = \mathbf{w}^T \mathbf{x} + b = \sum_{j = 1}^N w_j x_j + b
$$</p><p>where $\mathbf{w} \in \mathbb{R}^N$ is the weight vector and $b \in \mathbb{R}$ is the bias term.</p><p>From this value generated by the function, if $f(\mathbf{x}) > 0$, we predict class $+1$, otherwise we predict class $-1$, or just $sign(f(\mathbf{x}))$.</p><section><h5 id="geometric-interpretation-2">Geometric Interpretation</h5><p>As the name suggests, the linear classifier seperates the feature space into 2 half-spaces.</p><p>Each space corresponds to feature values belonging to class $+1$ and class $-1$.</p><p>The class boundary is <em>normal</em> (orthogonal or perpendicular since we are in 2D) to $\mathbf{w}$.
This boundary is also called the <strong>separating hyperplane</strong>.</p></section><section><h5 id="separating-hyperplane">Separating Hyperplane</h5><p>In an $N$-dimensional feature space, the parameters are $\mathbf{w} \in \mathbb{R}^N$.</p><p>The equation $\mathbf{w}^T \mathbf{x} + b = 0$ defines an $N-1$-dimensional linear surface.</p><ul>
<li>For $N = 2$,$\mathbf{w}$ defines a 1D line.</li>
<li>For $N = 3$, $\mathbf{w}$ defines a 2D plane.</li>
<li>For $N = n$, $\mathbf{w}$ defines a hyperplane.</li>
</ul></section></section></section>
<section><h3 id="training-a-linear-classifier">Training a Linear Classifier</h3><p>But how do we set these classifier parameters ($\mathbf{w}$, $b$)?</p><p>Simple, learn them from the data.
But depending on which approach we take, we get different classifiers.</p><p>Let’s take a look at the probabilistic approach.</p></section>
<section><h3 id="logistic-regression">Logistic Regression</h3><p>If we take the probabilistic route, we need to map the function value $f(\mathbf{x}) = \mathbf{w}^T \mathbf{x} + b$ to a probability (value between 0 and 1).</p><p>Luckily, the sigmoid function does exactly this. It maps any real number to the interval $[0, 1]$,
$$
\sigma(z) = \frac{1}{1 + e^{-z}}, \text{ for } z \in \mathbb{R}
$$</p><p>So, given a feature vector $\mathbf{x}$, the probability of a class is,
$$
p(y = +1 | \mathbf{x}) = \sigma(f(\mathbf{x})) \newline
p(y = -1 | \mathbf{x}) = 1 - \sigma(f(\mathbf{x})) = \sigma(-f(\mathbf{x})) \ | \ \text{since } \sigma(-z) = 1 - \sigma(z)
$$</p><p>or simply,
$$
p(y | \mathbf{x}) = \sigma(y f(\mathbf{x})).
$$</p><p>So the important thing here is that we are <strong>direcrtly</strong> modeling the class posterior probability, not the class-conditional probability.</p><section><h4 id="learning-the-parameters">Learning the Parameters</h4><p>Given the data set $\mathcal{D} = \{(\mathbf{x}^{(i)}, y^{(i)})\}_{i = 1}^M$, we can learn the parameters ($\mathbf{w}$, $b$) using MLE.</p><p>Maximize the conditional log likelihood of the data $\mathcal{D}$,
$$
\begin{align*}
(\mathbf{w}^\star, b^\star) &#x26;= \underset{\mathbf{w}, b}{\arg\max} \sum_{i = 1}^M \log p(y^{(i)} | \mathbf{x}^{(i)}, \mathbf{w}; b) \newline
&#x26;= \underset{\mathbf{w}, b}{\arg\max} -\frac{1}{M} \sum_{i = 1}^M \log (1 + \exp(-y^{(i)} (\mathbf{w}^T \mathbf{x}^{(i)} + b)))
\end{align*}
$$</p><p>To prevent <strong>overfitting</strong>, add a prior distribution on $\mathbf{w}$, for example, a Gaussian distribution with variance $C/2$.
$$
p(\mathbf{w}) \propto \exp\left(-\frac{1}{C} \mathbf{w}^T \mathbf{w}\right)
$$</p><p>Now maximize,
$$
\begin{align*}
(\mathbf{w}^\star, b^\star) &#x26;= \underset{\mathbf{w}, b}{\arg\max} \frac{1}{M} \sum_{i = 1}^M \log p(y^{(i)} | \mathbf{x}^{(i)}, \mathbf{w}; b) \newline
&#x26;= \underset{\mathbf{w}, b}{\arg\max} \frac{1}{M} \sum_{i = 1}^M \log \frac{p(\mathbf{w}, y^{(i)} | \mathbf{x}^{(i)}; b)}{p(y^{(i)} | \mathbf{x}^{(i)})} \newline
&#x26;= \underset{\mathbf{w}, b}{\arg\max} \frac{1}{M} \sum_{i = 1}^M \log \frac{p(\mathbf{w}) p(y^{(i)} | \mathbf{x}^{(i)}, \mathbf{w}; b)}{p(y^{(i)} | \mathbf{x}^{(i)})} \newline
&#x26;= \underset{\mathbf{w}, b}{\arg\max} \log p(\mathbf{w}) + \frac{1}{M} \sum_{i = 1}^M \log p(y^{(i)} | \mathbf{x}^{(i)}, \mathbf{w}; b) \newline
\end{align*}
$$</p><p>which equivalently,
$$
(\mathbf{w}^\star, b^\star) = \underset{\mathbf{w}, b}{\arg\min} \frac{1}{C} \mathbf{w}^T \mathbf{w} + \frac{1}{M} \sum_{i = 1}^M \log (1 + \exp(-y^{(i)} (\mathbf{w}^T \mathbf{x}^{(i)} + b)))
$$</p><p>The first term is the regularization term. Note that $\mathbf{w}^T \mathbf{w} = \sum_{j = 1}^N w_j^2$.
Therefore, this is a penalty term so $\mathbf{w}$ doesn’t get too large. $C$ is the regularization <strong>hyperparameter</strong>.
Larger $C$ allow large values in $\mathbf{w}$, smaller $C$ penalize large values in $\mathbf{w}$.</p><p>The second term is the data-fit term. This is what wants to make $(\mathbf{w}, b)$ fit the data.</p><p>If we define $z^{(i)} = y^{(i)} f(\mathbf{x}^{(i)})$, we have a interesting observation:</p><ul>
<li>$z^{(i)} > 0$ when sample $i$ is correctly classified.</li>
<li>$z^{(i)} &#x3C; 0$ when sample $i$ is incorrectly classified.</li>
<li>$z^{(i)} = 0$ when sample $i$ is on the decision boundary.</li>
</ul><section><h5 id="logistic-loss-function">Logistic Loss Function</h5><p>This leads us to define the <strong>logistic loss function</strong>,
$$
L(z) = log(1 + \exp(-z))
$$</p><p>$$
\underset{\mathbf{w}, b}{\arg\max} \log p(\mathbf{w}) + \frac{1}{M} \sum_{i = 1}^M \log p(y^{(i)} | \mathbf{x}^{(i)}, \mathbf{w}; b) \newline
$$</p><p><strong>No-closed-form solution</strong> to solve for $(\mathbf{w}, b)$, so we need to use <strong>numerical optimization</strong>.
For example, <strong>gradient descent</strong>.</p><ul>
<li>$\mathbf{w} \leftarrow \mathbf{w} - \eta \frac{\partial \ell}{\partial \mathbf{w}}$</li>
<li>$\ell$ is the objective function.</li>
<li>$\eta$ is the <strong>learning rate</strong>.</li>
</ul></section></section></section>
<section><h3 id="cross-validation">Cross-Validation</h3><p>We need to use <strong>cross-validation</strong> on <strong>training</strong> set to select the best value of $C$.</p><p>Run many experiments on the traning set to see which parameters work on different versions of the data.</p><p>First, partition the data into folds of training and validation data.
Try a range of $C$ values on each fold (as validation set).
Simply, pick the value that works best over all folds.</p><section><h4 id="cross-validation-algorithm">Cross-Validation Algorithm</h4><ul>
<li>Procedure
<ol>
<li>Select a range of $C$ values to try.</li>
<li>Repeat $K$ rounds:
<ol>
<li>Split the training set into training data and validation data.</li>
<li>Learn a classifier for each value of $C$.</li>
<li>Record the accuracy on the validation data for each $C$.</li>
</ol>
</li>
<li>Select the value of that has the highest average accuracy over all $K$ rounds.</li>
<li>Retrain the classifier using all data and the selected $C$.</li>
</ol>
</li>
</ul></section></section>
<section><h3 id="multiclass-classification">Multiclass Classification</h3><p>So far, we have only learned a classifier for 2 classes $y \in \{-1, +1\}$, also called a <strong>binary classifier</strong>.</p><p>For more than 2 classes, a good stragety is to simply, split the problem into several binary classifier problems.</p><section><h4 id="one-vs-rest">One-vs-Rest</h4><p>In this strategy, when we train, for each class, train a classifier for that class versus the other classes.</p><p>So for example, if we have 3 classes then we train 3 binary classifiers, $1$ vs $\{2, 3\}$, $2$ vs $\{1, 3\}$, and $3$ vs $\{1, 2\}$.</p><p>When predicitng, calculate the probablity for each binary classifier. Select the class with the highest probablity.</p></section></section>
<section><h3 id="multiclass-logistic-regression">Multiclass Logistic Regression</h3><p>Another way to get a multiclass classifier is to define a multiclass objective function.</p><p>One weight vector $\mathbf{w}_c$ for each class $c$. We omit the bias $b_c$ for each class for notational simplicity.</p><p>So, when we had the binary classifier we used the sigmoid function, for a multiclass objective, we need to use the <strong>softmax</strong> function.
Define probabilities with the softmax function,
$$
p(y = c | x) = \frac{\exp(\mathbf{w}_c^T \mathbf{x})}{exp(\mathbf{w}_1^T \mathbf{x}) + \ldots + \exp(\mathbf{w}_C^T \mathbf{x})}
$$</p><p>Here we need to estimate the $\{w_c\}_{c = 1}^C$ parameters using MLE as before.</p><section><h4 id="geometry-of-multiclass-logistic-regression">Geometry of Multiclass Logistic Regression</h4><p>In logistic regressino, it is explcitily designed to have a linear decision boundary in the binary case.</p><p>In the multiclass case, the decision boundary is <strong>piece-wise linear</strong>.</p></section></section>
<section><h3 id="logistic-regression-vs-nb-and-lda">Logistic Regression VS. NB and LDA</h3><ul>
<li>
<p>Speed</p>
<ul>
<li>Learning logistic regression requires iterative numerical optimization, which will be slower than NB and LDA.</li>
</ul>
</li>
<li>
<p>Storage</p>
<ul>
<li>The model requires $\mathcal{O}(N)$ parameters, the same order as NB but much less than LDA’s $\mathcal{O}(N^2)$.</li>
</ul>
<ul>
<li>Interpretability
<ul>
<li>The “importance” of feature $x_j$ can be understood in terms of the corresponding learned weight $w_j$.</li>
</ul>
</li>
</ul>
</li>
</ul><section><h4 id="logistic-regression-summary">Logistic Regression Summary</h4><ul>
<li>Classifier
<ul>
<li>Linear function $f(\mathbf{x}) = \mathbf{w}^T \mathbf{x} + b$.</li>
<li>Given a feature vector $\mathbf{x}$ the probability of a class is
<ul>
<li>$p(y = +1 | \mathbf{x}) = \sigma(f(\mathbf{x})), p(y = -1 | \mathbf{x}) = \sigma(-f(\mathbf{x}))$.</li>
<li>Sigmod function $\sigma(z) = \frac{1}{1 + e^{-z}}$.</li>
</ul>
</li>
</ul>
<ul>
<li>Logistic loss function $L(z) = \log(1 + \exp(-z))$.</li>
</ul>
</li>
<li>Training
<ul>
<li>Maximize the likelihood of the training data</li>
<li>Use regularization to prevent overfitting.
<ul>
<li>Use cross-validation to pick the regularization parameter $C$.</li>
</ul>
</li>
</ul>
</li>
<li>Classification
<ul>
<li>Given a new sample $\mathbf{x}^\star$, pick class with the highest $p(y | \mathbf{x}^\star)$.</li>
</ul>
</li>
</ul><p>$$
y^\star =
\begin{cases}
+1, &#x26; \frac{p(y = +1 | \mathbf{x}^\star)}{p(y = -1 | \mathbf{x}^\star)} > 1 \newline
-1, &#x26; \text{otherwise}
\end{cases}
$$</p><p>or simply,</p><p>$$
y^\star =
\begin{cases}
+1, &#x26; f(\mathbf{x}^\star) > 0 \newline
-1, &#x26; \text{otherwise}
\end{cases}
$$</p></section></section>


</body></html> </article> <div class="col-start-2"> <nav class="col-start-2 grid grid-cols-1 gap-4 sm:grid-cols-2"> <a href="/cityu/cs4487/cs4487_3" target="_self" class="duration-300 ease-in-out gap-2 whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&#38;_svg]:pointer-events-none [&#38;_svg:not([class*='size-'])]:size-4 shrink-0 [&#38;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 px-4 py-2 has-[>svg]:px-3 rounded-xl group flex items-center justify-start size-full" aria-disabled="false">  <svg width="1em" height="1em" viewBox="0 0 24 24" class="mr-2 size-4 transition-transform group-hover:-translate-x-1" data-icon="lucide:arrow-left">   <use href="#ai:lucide:arrow-left"></use>  </svg> <div class="flex flex-col items-start overflow-hidden text-wrap"> <span class="text-muted-foreground text-left text-xs">Next Post</span> <span class="w-full text-left text-sm text-ellipsis"> Part 3 - Optimization and Convexity </span> </div>  </a> <a href="/cityu/cs4487/cs4487" target="_self" class="duration-300 ease-in-out gap-2 whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&#38;_svg]:pointer-events-none [&#38;_svg:not([class*='size-'])]:size-4 shrink-0 [&#38;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 px-4 py-2 has-[>svg]:px-3 rounded-xl group flex items-center justify-end size-full" aria-disabled="false">  <div class="flex flex-col items-end overflow-hidden text-wrap"> <span class="text-muted-foreground text-right text-xs">Previous Post</span> <span class="w-full text-right text-sm text-ellipsis"> Part 1 - Introduction </span> </div> <svg width="1em" height="1em" viewBox="0 0 24 24" class="ml-2 size-4 transition-transform group-hover:translate-x-1" data-icon="lucide:arrow-right">   <use href="#ai:lucide:arrow-right"></use>  </svg>  </a> </nav> </div> <div class="col-start-2"> <div class="giscus"></div> <script data-astro-rerun src="https://giscus.app/client.js" data-repo="rezaarezvan/rezarezvan.com" data-repo-id="R_kgDOHvQr3w" data-category="General" data-category-id="DIC_kwDOHvQr384CiWVC" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="preferred_color_scheme" data-lang="en" data-loading="lazy" crossorigin="anonymous" async></script> </div> </section> <button data-slot="button" class="items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 size-9 group fixed right-8 bottom-8 z-50 hidden" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top"> <svg width="1em" height="1em" class="mx-auto size-4 transition-all group-hover:-translate-y-0.5" data-icon="lucide:arrow-up">   <symbol id="ai:lucide:arrow-up" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m5 12l7-7l7 7m-7 7V5"/></symbol><use href="#ai:lucide:arrow-up"></use>  </svg> </button> <script type="module">document.addEventListener("astro:page-load",()=>{const o=document.getElementById("scroll-to-top"),t=document.querySelector("footer");o&&t&&(o.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})}),window.addEventListener("scroll",()=>{const e=t.getBoundingClientRect().top<=window.innerHeight;o.classList.toggle("hidden",window.scrollY<=300||e)}))});</script>  </div> </main> <footer class="py-4"> <div class="mx-auto flex max-w-3xl flex-col items-center justify-center gap-y-2 px-4 sm:flex-row sm:justify-between"> <div class="flex flex-wrap items-center justify-center gap-x-2 text-center"> <span class="text-muted-foreground text-sm">
&copy; 2025 • rezarezvan.com </span> </div> </div> </footer> <div id="backdrop" class="invisible fixed top-0 left-0 z-50 flex h-screen w-full justify-center bg-[rgba(0,0,0,0.5)] p-6 backdrop-blur-sm" data-astro-transition-persist="astro-t6dxx5el-4"> <div id="pagefind-container" class="m-0 flex h-fit max-h-[80%] w-full max-w-screen-sm flex-col overflow-auto rounded border border-black/15 bg-neutral-100 p-2 px-4 py-3 shadow-lg dark:border-white/20 dark:bg-neutral-900"> <div id="search" class="pagefind-ui pagefind-init" data-pagefind-ui data-bundle-path="/pagefind/" data-ui-options="{&#34;showImages&#34;:false,&#34;excerptLength&#34;:15,&#34;resetStyles&#34;:false}"></div> <script type="module" src="/_astro/Search.astro_astro_type_script_index_0_lang.mBpmxV9R.js"></script> <div class="dark:prose-invert mr-2 pt-4 pb-1 text-right text-xs">
Press <span class="prose dark:prose-invert text-xs"><kbd class="">Esc</kbd></span> or click anywhere to close
</div> </div> </div> <script>
  document.addEventListener('DOMContentLoaded', () => {
    const magnifyingGlass = document.getElementById('magnifying-glass')
    const backdrop = document.getElementById('backdrop')

    function openPagefind() {
      const searchDiv = document.getElementById('search')
      const search = searchDiv.querySelector('input')
      setTimeout(() => {
        search.focus()
      }, 0)
      backdrop?.classList.remove('invisible')
      backdrop?.classList.add('visible')
    }

    function closePagefind() {
      const searchDiv = document.getElementById('search')
      const search = searchDiv.querySelector('input')
      if (search) {
        search.value = ''
      }
      backdrop?.classList.remove('visible')
      backdrop?.classList.add('invisible')
    }

    // open pagefind
    magnifyingGlass?.addEventListener('click', () => {
      openPagefind()
    })

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        closePagefind()
      }
    })

    // close pagefind when searched result(link) clicked
    document.addEventListener('click', (event) => {
      if (event.target.classList.contains('pagefind-ui__result-link')) {
        closePagefind()
      }
    })

    backdrop?.addEventListener('click', (event) => {
      if (!event.target.closest('#pagefind-container')) {
        closePagefind()
      }
    })

    // prevent form submission
    const form = document.getElementById('form')
    form?.addEventListener('submit', (event) => {
      event.preventDefault()
    })
  })
</script>  </div> </body></html>