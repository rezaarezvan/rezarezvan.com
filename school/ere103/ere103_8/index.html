<!DOCTYPE html>
<html><head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge"><title>rezvan | Part 8 - Stability</title><link rel="icon" type="image/png" href="https://rezvan.xyz/images/icon.png" /><meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description"
        content="Introduction In this part we&rsquo;ll properly define what stability is for different kind of systems.
Stability $G(s)$ is a stable system when:
$$ \lim_{t \to \infty} g(t) = 0 $$
Where $g(t)$ is the system impulse response, meaning $u(t) = \delta(t)$, which yields:
$$ g(t) = \mathcal{L}^{-1}\{G(s) = \dfrac{Y(s)}{U(s)} = Y(s) \} $$
Example $G(s) = \dfrac{1}{s^2 &#43; 4s - 5}$
We can rewrite it as: $$ G(s) = \dfrac{1}{s^2 &#43; 4s - 5} = \dfrac{1}{(s - 1)(s &#43; 5)} $$" />
    <meta property="og:image" content="https://raw.githubusercontent.com/rezaarezvan/rezvan.xyz/main/images/icon.png" />
    <meta property="og:url" content="https://rezvan.xyz/school/ere103/ere103_8/">
  <meta property="og:site_name" content="rezvan">
  <meta property="og:title" content="Part 8 - Stability">
  <meta property="og:description" content="Introduction In this part we’ll properly define what stability is for different kind of systems.
Stability $G(s)$ is a stable system when:
$$ \lim_{t \to \infty} g(t) = 0 $$
Where $g(t)$ is the system impulse response, meaning $u(t) = \delta(t)$, which yields:
$$ g(t) = \mathcal{L}^{-1}\{G(s) = \dfrac{Y(s)}{U(s)} = Y(s) \} $$
Example $G(s) = \dfrac{1}{s^2 &#43; 4s - 5}$
We can rewrite it as: $$ G(s) = \dfrac{1}{s^2 &#43; 4s - 5} = \dfrac{1}{(s - 1)(s &#43; 5)} $$">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="school">
    <meta property="article:published_time" content="2023-11-16T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-05-26T11:09:10+02:00">
<meta name="twitter:card" content="summary"><meta name="twitter:title" content="Part 8 - Stability">
<meta name="twitter:description" content="Introduction In this part we&rsquo;ll properly define what stability is for different kind of systems.
Stability $G(s)$ is a stable system when:
$$ \lim_{t \to \infty} g(t) = 0 $$
Where $g(t)$ is the system impulse response, meaning $u(t) = \delta(t)$, which yields:
$$ g(t) = \mathcal{L}^{-1}\{G(s) = \dfrac{Y(s)}{U(s)} = Y(s) \} $$
Example $G(s) = \dfrac{1}{s^2 &#43; 4s - 5}$
We can rewrite it as: $$ G(s) = \dfrac{1}{s^2 &#43; 4s - 5} = \dfrac{1}{(s - 1)(s &#43; 5)} $$">
<script src="https://rezvan.xyz/js/feather.min.js"></script>
    

    
    
    <link rel="stylesheet" type="text/css" media="screen" href="https://rezvan.xyz/css/main.6ad9c068c7f2d7d0babefb693af3dd601fb7b232014794a999404fb8994937e1.css" />
    <link id="lightSyntaxStyle" rel="stylesheet" type="text/css" media="screen" href="https://rezvan.xyz/css/light_syntax.65408cc3a5c02070b661c3e4e79306fc261cc63620f4adce9a30eafcba4ab79e.css" />
    
    <link id="darkModeStyle" rel="stylesheet" type="text/css" href="https://rezvan.xyz/css/dark.13c6bfb747b76fdd2dc198b1172afdd77e7ce604de43f343ce643378bafc58af.css"  disabled />
    <link id="darkSyntaxStyle" rel="stylesheet" type="text/css" media="screen" href="https://rezvan.xyz/css/dark_syntax.2b10cc1a2156b30874a063b7439a993bc3b43d476c5e1d8598d769c929c7b381.css" />
    

    
    
    <script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
        </script>

    
    <script type="text/x-mathjax-config">
		MathJax.Hub.Config({
			tex2jax: {
				inlineMath: [['$','$'], ['\\(','\\)']],
				displayMath: [['$$','$$'], ['\[','\]']],
				processEscapes: true,
				processEnvironments: true,
				skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
				TeX: { equationNumbers: { autoNumber: "AMS" },
						 extensions: ["AMSmath.js", "AMSsymbols.js"] }
			}
		});
		</script>
    

    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body);"></script>

    
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: "$$", right: "$$", display: true},
                    {left: "$", right: "$", display: false}
                ]
            });
        });
    </script>
    
</head>
<body>
    <div class="content"><header>
    <nav id="site-navbar">
        <div class="menu-items">
            
            <a href="/">home</a>
            
            <a href="/principles">principles</a>
            
            <a href="/cv">cv</a>
            
            <a href="/posts">posts</a>
            
            <a href="/school">school</a>
            
        </div>
        <div class="theme-toggle">
            <span id="dark-mode-toggle" onclick="toggleTheme()"><i data-feather="moon"></i></span>
            <script src="https://rezvan.xyz/js/themetoggle.js"></script>
        </div>
        
    </nav>
</header>

<main>
    <article>
        <div class="title">
            <h1>Part 8 - Stability</h1>
            <div class="meta">Posted on Nov 16, 2023
            </div>
            <div class="meta">
                (Last updated: May 26, 2024)
            </div>

        </div>
        
        <section class="body">
            <h3 id="introduction">Introduction</h3>
<p>In this part we&rsquo;ll properly define what stability is for different kind of systems.</p>
<h3 id="stability">Stability</h3>
<p>$G(s)$ is a stable system when:</p>
<p>$$
\lim_{t \to \infty} g(t) = 0
$$</p>
<p>Where $g(t)$ is the system impulse response, meaning $u(t) = \delta(t)$, which yields:</p>
<p>$$
g(t) = \mathcal{L}^{-1}\{G(s) = \dfrac{Y(s)}{U(s)} = Y(s) \}
$$</p>
<h3 id="example">Example</h3>
<p>$G(s) = \dfrac{1}{s^2 + 4s - 5}$</p>
<p>We can rewrite it as:
$$
G(s) = \dfrac{1}{s^2 + 4s - 5} = \dfrac{1}{(s - 1)(s + 5)}
$$</p>
<p>Using partial fraction decomposition:
$$
G(s) = \dfrac{A}{(s - 1)} + \dfrac{B}{(s + 5)}
$$</p>
<p>Taking the inverse Laplace transform yields:
$$
g(t) = A \cdot e^{t} + B \cdot e^{-5t}
$$</p>
<p>If we take:
$$
\lim_{t \to \infty} g(t) = \infty
$$</p>
<p>Since the first term explodes off to infinity.</p>
<p>This means that our condition in stability, can be defined as. The poles need to lie within the left-hand plane, meaning they have a real part that is negative.</p>
<p>But this is for simple systems, how does stability look like in a feedback system?</p>
<h3 id="stability-for-feedback-systems">Stability for feedback systems</h3>
<p>When dealing with feedback systems we need to look at the loop transfer function, $L(s) = F(s) G(s)$.</p>
<p>Remember that, the transfer function from $r(t)$ to $y(t)$ is:
$$
G_{ry}(s) = \dfrac{L(s)}{1 + L(s)}
$$</p>
<p>We will call $1 + L(s)$ for the characteristic equation. From the last part we can say that $1 + L(s) = 0$</p>
<h3 id="example-1">Example</h3>
<p>Given the system:</p>
<p>$$
G(s) = \dfrac{1}{s^2 + s - 2}
$$</p>
<p>We use a P-controller:
$$
F(s) = K_p
$$</p>
<p>This means $L(s) = \dfrac{K_p}{s^2 + s - 2}$</p>
<p>$$
1 + L(s) = 0 \\
1 + \dfrac{K_p}{s^2 + s -2} = 0 \\
s^2 + s - 2 + K_p = 0 \\
$$</p>
<p>This means:
$$
s_{1, 2} = -\dfrac{1}{2} \pm \sqrt{\dfrac{9}{4} - K_p}
$$</p>
<p>For our roots to not be positive, the square root term can at max be $\dfrac{1}{2}$. Meaning that:
$$
\dfrac{9}{4} - K_p &lt; \dfrac{1}{4}
$$</p>
<p>Which means:
$$
\boxed{K_p &gt; 2}
$$</p>
<h3 id="bode-plots-for-feedback-systems">Bode plots for feedback systems</h3>
<p>Given:</p>
<p>$$
G_{ry}(s) = \dfrac{L(s)}{1 + L(s)}
$$</p>
<p>What happens if $L(s) = -1$?</p>
<p>This means that $|L(j\omega)| = 1$ and $arg(L(j\omega)) = -180^\circ$</p>
<p>Let&rsquo;s call those specific frequencies for $\omega_c$ and $\omega_\pi$. We&rsquo;ll call them the crossover and phase crossover frequency respectievly.</p>
<p>Meaning that:
$$
|L(j\omega_c)| = 1 \\
arg(L(j\omega_\pi)) = -180^\circ
$$</p>
<p>If $L(j\omega) = -1$, it is equivalent to $\omega_c = \omega_\pi$. If this happens, the system is unstable.</p>
<p>Therefore, we will introduce two new variables that will tell us how near instability we are.</p>
<p>Phase margin:
$$
\phi_m = arg(L(j\omega_c)) - -180^\circ = arg(L(j\omega_C)) + 180^\circ \ | \ \text{ given that } |L(j\omega_c)| = 1
$$</p>
<p>Amplitude margin:</p>
<p>$$
A_m = \dfrac{1}{|L(j\omega_\pi)|} \ | \ \text{ given that } arg(L(j\omega_\pi)) = -180^\circ
$$</p>
<h3 id="example-2">Example</h3>
<p>Given
$$
L(s) = \dfrac{K}{s(s + 1)^2} \ K &gt; 0
$$</p>
<p>Given that $A_m = 2$, find $K$.</p>
<p>$$
2 = \dfrac{1}{|L(j\omega_\pi)|}
$$</p>
<p>This means that $|L(j\omega_\pi)| = \dfrac{1}{2}$</p>
<p>$$
L(j\omega) = \dfrac{K}{j\omega(j\omega + 1)^2}
$$</p>
<p>$$
arg(L(j\omega)) = 0 - 90^\circ - 2 \cdot arctan(\omega)
$$</p>
<p>Let&rsquo;s find $\omega_\pi$</p>
<p>$$
-90^\circ - 2 \cdot arctan(\omega_\pi) = -180^\circ \\
-2 \cdot arctan(\omega_\pi) = -90^\circ \\
arctan(\omega_\pi) = 45^\circ \\
\omega_\pi = 1
$$</p>
<p>Therefore:
$$
|L(j\omega_\pi)| = \left| \dfrac{K}{j(1 + j)^2} \right| = \dfrac{1}{2}
$$</p>
<p>$$
\dfrac{K}{1 \cdot \left(\sqrt{1^2 + 1^2}\right)^2} = \dfrac{1}{2}
$$</p>
<p>$$
\dfrac{K}{2} = \dfrac{1}{2}
$$</p>
<p>$$
\boxed{K = 1}
$$</p>
<h3 id="routhhurwitz-stability-criterion">Routh–Hurwitz stability criterion</h3>
<p>If we happen to get a polynomial of higher degrees than 2, then we need to find the poles still to determine stability. Solving a 3rd degree polynomial is not the most trivial task.</p>
<p>If we ever happen to get a polynomial of degree 4 than it is even worse. But if we reflect, we only want to know the sign of the poles, the actual values are useless if we want to just determine stability of a system.</p>
<p>Using this method we can easily find if a system is stable or not.</p>
<p>$1 + L(s)$ is a polynomial of degree higher than 2.
$$
1 + L(s) = a_0 s^n + a_1 s^{n - 1} + a_2 s^{n - 2} + \ldots + a_n
$$</p>
<p>To find the poles we set:
$$
a_0 s^n + a_1 s^{n - 1} + a_2 s^{n - 2} + \ldots + a_n = 0
$$</p>
<p>We write the following table:</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$s^n$</td>
<td style="text-align:center">$a_0$</td>
<td style="text-align:center">$a_2$</td>
<td style="text-align:center">$a_4$</td>
<td style="text-align:center">$a_6$</td>
</tr>
<tr>
<td style="text-align:center">$s^{n - 1}$</td>
<td style="text-align:center">$a_1$</td>
<td style="text-align:center">$a_3$</td>
<td style="text-align:center">$a_5$</td>
<td style="text-align:center">$a_7$</td>
</tr>
<tr>
<td style="text-align:center">$s^{n - 2}$</td>
<td style="text-align:center">$c_0$</td>
<td style="text-align:center">$c_1$</td>
<td style="text-align:center">$c_2$</td>
<td style="text-align:center">$c_3$</td>
</tr>
<tr>
<td style="text-align:center">$s^{n - 3}$</td>
<td style="text-align:center">$d_0$</td>
<td style="text-align:center">$d_1$</td>
<td style="text-align:center">$d_2$</td>
<td style="text-align:center">$d_3$</td>
</tr>
</tbody>
</table>
<p>And so on</p>
<p>We&rsquo;ll define these new characters as:
$$
c_0 = \dfrac{a_1 a_2 - a_0 a_3}{a_1} \\
c_1 = \dfrac{a_1 a_4 - a_0 a_5}{a_1} \\
c_2 = \dfrac{a_1 a_6 - a_0 a_7}{a_1} \\
$$</p>
<p>$$
d_0 = \dfrac{c_0 a_3 - a_1 c_1}{c_0} \\
d_1 = \dfrac{c_0 a_5 - a_1 c_2}{c_0} \\
d_2 = \dfrac{c_0 a_7 - a_1 c_3}{c_0} \\
$$</p>
<p>If the first column only contains positive numbers, then the system is stable!</p>
<h3 id="example-3">Example</h3>
<p>For what $K$ values is the system stable?
$$
L(s) = \dfrac{K}{s} \cdot \dfrac{3}{(s + 1)^2} = \dfrac{3K}{s(s^2 + 2s + 1)} = \dfrac{3K}{s^3 + 2s^2 + s}
$$</p>
<p>$$
1 + L(s) = 0\\
1 + \dfrac{3K}{s^3 + 2s^2 + s} = 0 \\
s^3 + 2s^2 + s + 3K = 0 \\
$$</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$s^3$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$0$</td>
<td style="text-align:center">$0$</td>
</tr>
<tr>
<td style="text-align:center">$s^2$</td>
<td style="text-align:center">$2$</td>
<td style="text-align:center">$3k$</td>
<td style="text-align:center">$0$</td>
<td style="text-align:center">$0$</td>
</tr>
<tr>
<td style="text-align:center">$s^1$</td>
<td style="text-align:center">$c_0$</td>
<td style="text-align:center">$c_1$</td>
<td style="text-align:center">$c_2$</td>
<td style="text-align:center">$c_3$</td>
</tr>
<tr>
<td style="text-align:center">$s^0$</td>
<td style="text-align:center">$d_0$</td>
<td style="text-align:center">$d_1$</td>
<td style="text-align:center">$d_2$</td>
<td style="text-align:center">$d_3$</td>
</tr>
</tbody>
</table>
<p>$$
c_0 = \dfrac{a_1 a_2 - a_0 a_3}{a_1} = \dfrac{2 - 3K}{2} \\
c_1 = \dfrac{a_1 a_4 - a_0 a_5}{a_1} = 0\\
$$</p>
<p>$$
d_0 = \dfrac{c_0 a_3 - a_1 c_1}{c_0} = \dfrac{\dfrac{2 - 3K}{2} \cdot 3K}{\dfrac{2 - 3K}{2}} = 3K \\
$$</p>
<p>It is stable if $c_0$ and $d_0 &gt; 0$.
$$
\dfrac{2 - 3K}{2} &gt; 0 \\
3K &gt; 0 \\
$$</p>
<p>This means that:
$$
\boxed{0 &lt; K &lt; \dfrac{2}{3}}
$$</p>
<h3 id="systems-with-non-rational-transfer-function">Systems with non-rational transfer function</h3>
<p>In reality, we will deal with transfer function that may not always be rational functions, for example
$$
L(s) = e^{-3s}{s(s + 1)}
$$</p>
<p>This has a time delay, which makes it a non-rational function.</p>
<p>For these kinds we will use:</p>
<ul>
<li>Nyquists simplified criterion</li>
<li>Nyquists criterion</li>
</ul>
<h3 id="nyquists-simplified-criterion">Nyquists simplified criterion</h3>
<p>This is only applicable if $L(s)$ does not have any poles in the right-hand plane.</p>
<p>What you will do is that you plot $L(j\omega)$ for $0 \leq \omega \leq \infty$.</p>
<p>If the curve for $L(j\omega)$ passes through the negative real-axis with the point $(-1, 0)$ to the <strong>left</strong>, it is stable. If it is to the <strong>right</strong>, then it is unstable.</p>
<h3 id="example-4">Example</h3>
<p>$$
L(s) = \dfrac{e^{-s}}{s(1 + s)}
$$</p>
<p>Gives us the following plot:
<img src="/school/images/nyquist.png#center" alt=""></p>
<p>Which means this system is stable!</p>
<h3 id="example-5">Example</h3>
<p>Say we have the process, $G(s) = \dfrac{1}{(s + 1)(s + 2)}$. Say we have the controller, $F(s) = \dfrac{K}{s}$.</p>
<p>For what values on $K$ is the system stable?</p>
<p>$$
L(s) = \dfrac{K}{s(s + 1)(s + 2)}
$$</p>
<p>All poles lie in the left-hand plane, we can use the simplified criterion.</p>
<p>$$
L(j\omega) = \dfrac{K}{j\omega(j\omega + 1)(j\omega + 2)}
$$</p>
<p>Let&rsquo;s now split this fraction into the real and imaginary part. For this we&rsquo;ll need to multiply by the conjugates:
$$
L(j\omega) = \dfrac{K(1 - j\omega)(2 - j\omega)}{j\omega(1 + \omega^2)(2^2 + \omega^2)}
$$</p>
<p>Let&rsquo;s simplify:
$$
L(j\omega) = \dfrac{K(2 - 3j\omega -\omega^2)}{j\omega(1 + \omega^2)(2^2 + \omega^2)}
$$</p>
<p>$$
L(j\omega) = \dfrac{2K - 3Kj\omega - K\omega^2}{j\omega(1 + \omega^2)(2^2 + \omega^2)}
$$</p>
<p>$$
L(j\omega) = \dfrac{-3Kj\omega - K(2 - \omega^2)}{j\omega(1 + \omega^2)(2^2 + \omega^2)}
$$</p>
<p>$$
L(j\omega) = \dfrac{-3Kj\omega - K(2 - \omega^2)}{j\omega(1 + \omega^2)(2^2 + \omega^2)}
$$</p>
<p>$$
L(j\omega) = \dfrac{-3Kj\omega}{j\omega(1 + \omega^2)(2^2 + \omega^2)} - \dfrac{K(2 - \omega^2)}{j\omega(1 + \omega^2)(2^2 + \omega^2)}
$$</p>
<p>$$
L(j\omega) = \dfrac{-3K}{(1 + \omega^2)(2^2 + \omega^2)} + j\dfrac{K(2 - \omega^2)}{\omega(1 + \omega^2)(2^2 + \omega^2)}
$$</p>
<p>When we cross the negative real-axis is equivalent to $\Im(L(j\omega)) = 0$</p>
<p>$$
\dfrac{K(2 - \omega^2)}{\omega(1 + \omega^2)(2^2 + \omega^2)} = 0 \\
K(2 - \omega^2) = 0
$$</p>
<p>This means that when $\omega = \sqrt{2}$</p>
<p>This means that:
$$
\Re(L(j\sqrt{2})) = \dfrac{-3K}{1 + \sqrt{2})^2(4 + \sqrt{2})^2} = \ldots = -\dfrac{K}{6}
$$</p>
<p>We want this to the <strong>left</strong>, meaning:
$$
-\dfrac{K}{6} &gt; -1 \\
-K &gt; -6 \\
K &lt; 6 \\
$$</p>
<p>Let&rsquo;s plot for different K values and see.</p>
<p>For $K = 2$:
<img src="/school/images/k2.png#center" alt=""></p>
<p>For $K = 6$:
<img src="/school/images/k6.png#center" alt=""></p>
<p>For $K = 12$:
<img src="/school/images/k12.png#center" alt=""></p>
<h3 id="nyquist-criterion">Nyquist criterion</h3>
<p>The proof and intution behind the Nyquist criterion is quite a lot and requires knowledge in complex analysis. We don&rsquo;t do that here.</p>
<p>Simply, if we have a system with poles in the right-hand plane, we will need to use the general Nyquist criterion.</p>
<p>What we will use is:
$$
Z = N + P
$$</p>
<p>Where:</p>
<p>$Z$ is the number of <strong>zeroes</strong> $1 + L(s)$ has in the right-hand plane.
$P$ is the number of <strong>poles</strong> $L(s)$ has in the right-hand plane.
$N$ is the number of turns $L(s)$ has around $(-1, 0)$ in the clockwise direction.</p>
<p>If:
$$
Z = N + P = 0
$$</p>
<p>Then the system is said to be stable.</p>

        </section>
    </article>

    <nav class="navigation">
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        

        
        

        <div class="nav-item previous">
            
            
            <a href="/school/ere103/ere103_7/" title="Previous: Part 7 - Bode plot">&larr; Previous</a>
            
            
        </div>

        <div class="nav-item next">
            
            
            <a href="/school/ere103/ere103_9/" title="Next: Part 9 - General controller structure">Next &rarr;</a>
            
            
        </div>
    </nav>
</main>
<footer id="site-footer">
    <div class="social-links">
        
        <a href="https://github.com/rezaarezvan" title="">github</a>
        
        <a href="https://x.com/rzvan__/" title="">x</a>
        
    </div><p class="footer-msg">memento mori</p>
</footer></div>
</body>

</html>
